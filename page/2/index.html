<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="Lonely920" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="Lonely920">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Lonely920">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Lonely920">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/page/2/"/>

  <title> Lonely920 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Lonely920</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Sun</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/08/UIGestureRecognizer/" itemprop="url">
                  UIGestureRecognizer
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-08T10:31:23+08:00" content="2016-07-08">
              2016-07-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UI/" itemprop="url" rel="index">
                    <span itemprop="name">UI</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>为了完成手势识别，必须借助于手势识别器——UIGestureRecognizer</li>
<li>利用UIGestureRecognizer，能轻松识别用户在某个view上面做的一些常见手势</li>
<li><p>UIGestureRecognizer是一个抽象类，定义了所有手势的基本行为，使用它的子类才能处理具体的手势</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UITapGestureRecognizer</span>(点按)</div><div class="line"><span class="built_in">UIPinchGestureRecognizer</span>(捏合，用于缩放)</div><div class="line"><span class="built_in">UIPanGestureRecognizer</span>(平移)</div><div class="line"><span class="built_in">UISwipeGestureRecognizer</span>(轻扫)</div><div class="line"><span class="built_in">UIRotationGestureRecognizer</span>(旋转)</div><div class="line"><span class="built_in">UILongPressGestureRecognizer</span>(长按)</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="一、UITapGestureRecognizer（点击）"><a href="#一、UITapGestureRecognizer（点击）" class="headerlink" title="一、UITapGestureRecognizer（点击）"></a>一、UITapGestureRecognizer（点击）</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UITapGestureRecognizer</span> *tap=[[<span class="built_in">UITapGestureRecognizer</span> alloc] initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(click)];</div><div class="line">    <span class="comment">//设置当前需要点击的次数</span></div><div class="line">    [tap setNumberOfTapsRequired:<span class="number">1</span>];</div><div class="line">    <span class="comment">//设置当前需要触发事件的手指数量</span></div><div class="line">	[tap setNumberOfTouchesRequired:<span class="number">2</span>];</div><div class="line">	<span class="comment">//设置当前代理</span></div><div class="line">	tap.delegate=<span class="keyword">self</span>;</div><div class="line">	[_view addGestureRecognizer:tap];</div><div class="line">	</div><div class="line"><span class="comment">//触发方法</span></div><div class="line">- (<span class="keyword">void</span>) click&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"当前视图被点击了！ "</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="二、UILongPressGestureRecognizer-长按"><a href="#二、UILongPressGestureRecognizer-长按" class="headerlink" title="二、UILongPressGestureRecognizer(长按)"></a>二、UILongPressGestureRecognizer(长按)</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UILongPressGestureRecognizer</span> * longPress=[[<span class="built_in">UILongPressGestureRecognizer</span> alloc] initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(longPress)];</div><div class="line"><span class="comment">//设置当前长按最小的时长</span></div><div class="line">longPress.minimumPressDuration=<span class="number">2</span>;</div><div class="line"><span class="comment">//设置允许的移动范围</span></div><div class="line"> [longPress setAllowableMovement:<span class="number">2</span>];</div><div class="line">[_view addGestureRecognizer:longPress];</div><div class="line"></div><div class="line"><span class="comment">//触发方法</span></div><div class="line">- (<span class="keyword">void</span>) longPress&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"长按事件触发！ "</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="三、UISwipeGestureRecognizer-轻扫"><a href="#三、UISwipeGestureRecognizer-轻扫" class="headerlink" title="三、UISwipeGestureRecognizer(轻扫)"></a>三、UISwipeGestureRecognizer(轻扫)</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UISwipeGestureRecognizer</span> * swip=[[<span class="built_in">UISwipeGestureRecognizer</span> alloc] initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(swipMethod)];</div><div class="line"><span class="comment">//往左边方向</span></div><div class="line">swip.direction=<span class="built_in">UISwipeGestureRecognizerDirectionLeft</span>;</div><div class="line"><span class="comment">//往右边方向</span></div><div class="line">swip.direction=<span class="built_in">UISwipeGestureRecognizerDirectionRight</span>;</div><div class="line"><span class="comment">//往上面方向</span></div><div class="line">swip.direction=<span class="built_in">UISwipeGestureRecognizerDirectionUp</span>;</div><div class="line"><span class="comment">//往下面方向</span></div><div class="line">swip.direction=<span class="built_in">UISwipeGestureRecognizerDirectionDown</span>;</div><div class="line">    [_view addGestureRecognizer:swip];</div><div class="line">    </div><div class="line"><span class="comment">//触发方法</span></div><div class="line">- (<span class="keyword">void</span>) swipMethod&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"轻扫事件触发！ "</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>如果涉及到2个以上方向的手势最好添加多个UISwipeGestureRecognizer 对象并设置不同的方向，不要通过下面方式用符号|来连接:</strong></p>
<figure class="highlight objc"><figcaption><span>swip.direction=UISwipeGestureRecognizerDirectionLeft  | UISwipeGestureRecognizerDirectionRight  </span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">```</div><div class="line">	</div><div class="line"><span class="meta">## 四、UIPanGestureRecognizer(平移)</span></div><div class="line"><span class="meta">#### 第一步：添加视图</span></div><div class="line">```objc</div><div class="line">_view=[[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">50</span>, <span class="number">250</span>, <span class="number">300</span>, <span class="number">200</span>)];</div><div class="line">[_view setBackgroundColor:[<span class="built_in">UIColor</span> redColor]];</div><div class="line">[<span class="keyword">self</span>.view addSubview:_view];</div></pre></td></tr></table></figure>
<h4 id="第二步：添加手势"><a href="#第二步：添加手势" class="headerlink" title="第二步：添加手势"></a>第二步：添加手势</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIPanGestureRecognizer</span> *pan=[[<span class="built_in">UIPanGestureRecognizer</span> alloc] initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(paned:)];</div><div class="line">[_view addGestureRecognizer:pan];</div></pre></td></tr></table></figure>
<h4 id="第三步：实现方法"><a href="#第三步：实现方法" class="headerlink" title="第三步：实现方法"></a>第三步：实现方法</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>) paned:(<span class="built_in">UIPanGestureRecognizer</span> *) pan&#123;</div><div class="line">    </div><div class="line">    <span class="comment">//获取移动的大小</span></div><div class="line">    <span class="built_in">CGPoint</span> point= [pan translationInView:pan.view];</div><div class="line">    <span class="comment">//更改视图的中心点坐标</span></div><div class="line">    <span class="built_in">CGPoint</span> points=_view.center;</div><div class="line">    points.x+=point.x;</div><div class="line">    points.y+=point.y;</div><div class="line">    _view.center=points;</div><div class="line">    <span class="comment">//每次都清空一下消除坐标叠加</span></div><div class="line">    [pan setTranslation:<span class="built_in">CGPointZero</span> inView:pan.view];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="五、UIRotationGestureRecognizer-旋转"><a href="#五、UIRotationGestureRecognizer-旋转" class="headerlink" title="五、UIRotationGestureRecognizer(旋转)"></a>五、UIRotationGestureRecognizer(旋转)</h2><h4 id="第一步：添加视图"><a href="#第一步：添加视图" class="headerlink" title="第一步：添加视图"></a>第一步：添加视图</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">_view=[[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">50</span>, <span class="number">250</span>, <span class="number">300</span>, <span class="number">200</span>)];</div><div class="line">[_view setBackgroundColor:[<span class="built_in">UIColor</span> redColor]];</div><div class="line">[<span class="keyword">self</span>.view addSubview:_view];</div></pre></td></tr></table></figure>
<h4 id="第二步：添加手势-1"><a href="#第二步：添加手势-1" class="headerlink" title="第二步：添加手势"></a>第二步：添加手势</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIRotationGestureRecognizer</span> * roate=[[<span class="built_in">UIRotationGestureRecognizer</span> alloc] initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(rotate:)];</div><div class="line">    [_view addGestureRecognizer:roate];</div><div class="line">roate.delegate=<span class="keyword">self</span>;</div></pre></td></tr></table></figure>
<h4 id="第三步：实现方法-1"><a href="#第三步：实现方法-1" class="headerlink" title="第三步：实现方法"></a>第三步：实现方法</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>) rotate:(<span class="built_in">UIRotationGestureRecognizer</span> *) rote&#123;</div><div class="line">   <span class="comment">//获取当前旋转的度数</span></div><div class="line">   <span class="built_in">CGFloat</span> rotation= rote.rotation;</div><div class="line">    <span class="comment">//通过仿射变换实现旋转</span></div><div class="line">  _view.transform=<span class="built_in">CGAffineTransformRotate</span>(_view.transform, rotation);</div><div class="line">    <span class="comment">//防止旋转叠加需要清零</span></div><div class="line">    rote.rotation=<span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="六、UIPinchGestureRecognizer-捏合"><a href="#六、UIPinchGestureRecognizer-捏合" class="headerlink" title="六、UIPinchGestureRecognizer(捏合)"></a>六、UIPinchGestureRecognizer(捏合)</h2><h4 id="第一步：添加视图-1"><a href="#第一步：添加视图-1" class="headerlink" title="第一步：添加视图"></a>第一步：添加视图</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">_view=[[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">50</span>, <span class="number">250</span>, <span class="number">300</span>, <span class="number">200</span>)];</div><div class="line">[_view setBackgroundColor:[<span class="built_in">UIColor</span> redColor]];</div><div class="line">[<span class="keyword">self</span>.view addSubview:_view];</div></pre></td></tr></table></figure>
<h4 id="第二步：添加手势-2"><a href="#第二步：添加手势-2" class="headerlink" title="第二步：添加手势"></a>第二步：添加手势</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIPinchGestureRecognizer</span> * pich=[[<span class="built_in">UIPinchGestureRecognizer</span> alloc] initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(piches:)];</div><div class="line">[_view addGestureRecognizer:pich];</div><div class="line">pich.delegate=<span class="keyword">self</span>;</div></pre></td></tr></table></figure>
<h4 id="第三步：实现方法-2"><a href="#第三步：实现方法-2" class="headerlink" title="第三步：实现方法"></a>第三步：实现方法</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>) piches:(<span class="built_in">UIPinchGestureRecognizer</span> *) pich&#123;</div><div class="line">    <span class="comment">//获取比例</span></div><div class="line">    <span class="built_in">CGFloat</span> scale=pich.scale;</div><div class="line">    <span class="comment">//通过仿射变换实现缩放</span></div><div class="line">    _view.transform=<span class="built_in">CGAffineTransformScale</span>(_view.transform, scale, scale);</div><div class="line">    <span class="comment">//防止比例叠加需要置为1</span></div><div class="line">    pich.scale=<span class="number">1</span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h2 id="补充：如果需要同时响应多个手势需要重写代理方法"><a href="#补充：如果需要同时响应多个手势需要重写代理方法" class="headerlink" title="补充：如果需要同时响应多个手势需要重写代理方法"></a>补充：如果需要同时响应多个手势需要重写代理方法</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)gestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)otherGestureRecognizer&#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/08/文件上传/" itemprop="url">
                  文件上传
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-08T10:31:23+08:00" content="2016-07-08">
              2016-07-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/网络与多线程/" itemprop="url" rel="index">
                    <span itemprop="name">网络与多线程</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、POST上传单个文件"><a href="#一、POST上传单个文件" class="headerlink" title="一、POST上传单个文件"></a>一、POST上传单个文件</h2><p><strong>重点:1.单个文件上传(四个步骤) 2.设置请求体格式</strong></p>
<h4 id="1、为什么要上传文件"><a href="#1、为什么要上传文件" class="headerlink" title="1、为什么要上传文件:"></a>1、为什么要上传文件:</h4><ul>
<li>以前很多服务器对上传文件的大小有限制,PHP 限制是 2M</li>
<li>目前很多服务器不仅不限制大小,而且鼓励上传多个文件!</li>
<li>云服务器的普及!</li>
<li>软件商希望获得更多的用户数据!</li>
</ul>
<p><strong>提示:abc 的目录是用来保存上传文件的,需要设置访问权限!</strong></p>
<h4 id="2、步骤"><a href="#2、步骤" class="headerlink" title="2、步骤"></a>2、步骤</h4><h6 id="1、文件上传使用-POST-方法"><a href="#1、文件上传使用-POST-方法" class="headerlink" title="1、文件上传使用 POST 方法"></a>1、文件上传使用 POST 方法</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 请求为可变请求</span></div><div class="line"><span class="built_in">NSMutableURLRequest</span> *request = [<span class="built_in">NSMutableURLRequest</span> requestWithURL:url];</div><div class="line"><span class="comment">// 制定请求方法为 POST</span></div><div class="line">request.HTTPMethod = <span class="string">@"POST"</span>;</div></pre></td></tr></table></figure>
<h6 id="2、设置请求头-告诉服务器请求体中的内容包含文件参数"><a href="#2、设置请求头-告诉服务器请求体中的内容包含文件参数" class="headerlink" title="2、设置请求头,告诉服务器请求体中的内容包含文件参数"></a>2、设置请求头,告诉服务器请求体中的内容包含文件参数</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[request setValue:<span class="string">@"multipart/form-data; boundary=kBoundary"</span> forHTTPHeaderField:<span class="string">@"Content-Type"</span>];</div></pre></td></tr></table></figure>
<h6 id="3、设置请求体-注意-必须严格按照格式设置"><a href="#3、设置请求体-注意-必须严格按照格式设置" class="headerlink" title="3、设置请求体(注意:必须严格按照格式设置)"></a>3、设置请求体(注意:必须严格按照格式设置)</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 上边界</span></div><div class="line">--boundary\r\n</div><div class="line">Content-Disposition: form-data; name=userfile; filename=<span class="number">555</span>\r\n</div><div class="line">Content-Type: application/json\r\n\r\n</div><div class="line">文件内容的二进制数据</div><div class="line"><span class="comment">// 下边界</span></div><div class="line">\r\n--boundary--</div><div class="line">注意<span class="number">1</span>:请求体内容分为三个部分:</div><div class="line">* 上边界部分,告诉服务器要做数据上传,包含了服务器的接收字段name=userfile,文件在服务器中保存的名称filename=<span class="number">555</span>,以及上传文件的数据类型 application/json(需要严格按照字符串格式来设置)</div><div class="line">* 上传文件的数据部分(二进制数据)</div><div class="line">* 下边界部分,严格按照字符串格式来设置.</div><div class="line">上边界部分和下边界部分的字符串,最后都要转换成二进制数据,和文件部分的二进制数据拼接在一起,作为请求体发送给服务器.</div><div class="line">注意<span class="number">2</span>:</div><div class="line">* userfile =&gt; 负责上传文件脚本中的 字段名,开发的时候,可以咨询后端程序员</div><div class="line">* filename =&gt; 将文件保存在服务器上的文件名称</div><div class="line">* Content-Type: 客户端告诉服务器上传文件的文件类型</div><div class="line">注意<span class="number">3</span>:</div><div class="line">* 每一行末尾需要有一定的 \r\n</div><div class="line">* 提示：有些服务器可以直接使用 \n，但是新浪微博如果使用 \n 上传文件，服务器会返回“没有权限”的错误！</div></pre></td></tr></table></figure>
<h6 id="4、发送请求-用-NSURLConnection异步发送请求"><a href="#4、发送请求-用-NSURLConnection异步发送请求" class="headerlink" title="4、发送请求(用 NSURLConnection异步发送请求)"></a>4、发送请求(用 NSURLConnection异步发送请求)</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[<span class="built_in">NSURLConnection</span> sendAsynchronousRequest:request queue:[<span class="built_in">NSOperationQueue</span> mainQueue] completionHandler:^(<span class="built_in">NSURLResponse</span> *response, <span class="built_in">NSData</span> *data, <span class="built_in">NSError</span> *connectionError) &#123;</div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="built_in">NSString</span> *string = [[<span class="built_in">NSString</span> alloc] initWithData:data encoding:<span class="built_in">NSUTF8StringEncoding</span>];</div><div class="line">    </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,string);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<h2 id="二、多文件上传"><a href="#二、多文件上传" class="headerlink" title="二、多文件上传"></a>二、多文件上传</h2><p><strong>重点:1.掌握多文件上传的数据格式 2.学会封装多文件上传的方法</strong><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">多文件上传和单文件上传的基本思路是一样的,唯一的区别在于对请求体的封装.</div><div class="line">多文件的请求体部分格式<span class="number">1</span></div><div class="line">&#123;</div><div class="line">    <span class="comment">// 第一个文件参数的上边界</span></div><div class="line">    \r\n--boundary\r\n</div><div class="line">    Content-Disposition: form-data; name=userfile[]; filename=美女\r\n</div><div class="line">    Content-Type:image/jpeg\r\n\r\n</div><div class="line">    上传文件的二进制数据部分</div><div class="line">    <span class="comment">// 第一个文件参数的下边界</span></div><div class="line">    \r\n--boundary--</div><div class="line">    <span class="comment">// 第二个文件参数的上边界</span></div><div class="line">    \r\n--boundary\r\n</div><div class="line">    Content-Disposition: form-data; name=userfile[]; filename=JSON\r\n</div><div class="line">    Content-Type:text/plain\r\n\r\n</div><div class="line">    上传文件的二进制数据部分</div><div class="line">    <span class="comment">// 第二个文件参数的下边界</span></div><div class="line">    \r\n--boundary--</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#123;</div><div class="line">    多文件上传的请求体格式<span class="number">2</span></div><div class="line">    <span class="comment">// 上边界</span></div><div class="line">    <span class="comment">// 第一个文件参数</span></div><div class="line">    \r\n--boundary\r\n</div><div class="line">    Content-Disposition: form-data; name=userfile[]; filename=美女\r\n</div><div class="line">    Content-Type:image/jpeg\r\n\r\n</div><div class="line">    上传文件的二进制数据部分</div><div class="line">    <span class="comment">// 第二个文件参数</span></div><div class="line">    \r\n--boundary\r\n</div><div class="line">    Content-Disposition: form-data; name=userfile[]; filename=JSON\r\n</div><div class="line">    Content-Type:text/plain\r\n\r\n</div><div class="line">    上传文件的二进制数据部分</div><div class="line">    <span class="comment">// 下边界</span></div><div class="line">    \r\n--boundary--</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="三、获取文件的-MIMEType"><a href="#三、获取文件的-MIMEType" class="headerlink" title="三、获取文件的 MIMEType"></a>三、获取文件的 MIMEType</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">上传文件的时候,需要告诉服务器文件类型(即Content-Type),这时,需要获取文件的 MIMEType.</div><div class="line"></div><div class="line">获取文件的 MIMEType 方法:加载文件时,通过 response 获得</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSURLRequest</span> *request = [<span class="built_in">NSURLRequest</span> requestWithURL:url];</div><div class="line">    </div><div class="line">    <span class="built_in">NSURLResponse</span> *response = <span class="literal">nil</span>;</div><div class="line">    </div><div class="line">    [<span class="built_in">NSURLConnection</span> sendSynchronousRequest:request returningResponse:&amp;response error:<span class="literal">NULL</span>];</div><div class="line">    </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,response.MIMEType);</div><div class="line">    </div><div class="line">&#125;</div><div class="line">response.MIMEType 即为 Content-Type 的类型.</div><div class="line"></div><div class="line">如果不想告诉服务器具体的文件类型,可以使用这个 Content-Type : application/octet-stream(<span class="number">8</span>进制流)</div><div class="line"></div><div class="line">常见的 Content-Type 类型:</div><div class="line">&#123;</div><div class="line">    - 大类型/小类型</div><div class="line">    - text/plain</div><div class="line">    - image/jpg</div><div class="line">    - image/png</div><div class="line">    - image/gif</div><div class="line">    - text/html</div><div class="line">    - application/json</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="四、多文件-普通文本上传"><a href="#四、多文件-普通文本上传" class="headerlink" title="四、多文件 + 普通文本上传"></a>四、多文件 + 普通文本上传</h2><ul>
<li>有些服务器可以在上传文件的同时,提交一些文本内容给服务器</li>
<li>典型应用:<ul>
<li><1>新浪微博: 上传图片的同时,发送一条微博信息!</1></li>
<li><2>购物评论: 购买商品之后发表评论的时候图片+评论内容!</2></li>
</ul>
</li>
<li><p>多文件上传的数据格式：</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">Content-Type: multipart/form-data; boundary=boundary</div><div class="line"><span class="comment">// ------ 以下内容，是提供给服务器的二进制数据格式</span></div><div class="line">--boundary\r\n</div><div class="line">Content-Disposition: form-data; name=<span class="string">"userfile[]"</span>; filename=<span class="string">"aaa.txt"</span>\r\n</div><div class="line">Content-Type: application/octet-stream\r\n\r\n</div><div class="line"></div><div class="line">文件二进制数据</div><div class="line">\r\n</div><div class="line">--boundary\r\n</div><div class="line">Content-Disposition: form-data; name=<span class="string">"userfile[]"</span>; filename=<span class="string">"aaa副本.txt"</span>\r\n</div><div class="line">Content-Type: application/octet-stream\r\n\r\n</div><div class="line"></div><div class="line">文件二进制数据</div><div class="line">\r\n</div><div class="line">--boundary\r\n</div><div class="line"><span class="comment">// username 是脚本文件接收参数的名称</span></div><div class="line">Content-Disposition: form-data; name=<span class="string">"username"</span>\r\n\r\n</div><div class="line"></div><div class="line">普通文本二进制数据</div><div class="line">\r\n</div><div class="line">--boundary--</div><div class="line"><span class="comment">// ------</span></div></pre></td></tr></table></figure>
<p>  以上部分，是发送给服务器的二进制数据的组成格式(示例)</p>
</li>
<li><p>如果在 iOS 中,要实现POST上传文件,需要按照上述格式,拼接数据!</p>
</li>
<li>因为:格式是 W3C 指定的标准格式,苹果没有做任何封装!其他语言,都做了封装!</li>
<li>以上三种数据拼接格式,需要大家了解并且能够自己会拼接一种!</li>
<li>“第三方框架做文件上传:<ul>
<li>AFN 能够同时实现上传”一个文件”,有些格式的文件,用 AFN 无法上传!</li>
<li>ASI 能够同时实现上传多个文件,MRC的,2012年就停止更新了,设计的目标平台, iOS 2.0/iOS 3.0 !</li>
</ul>
</li>
</ul>
<h2 id="五、RESTful设计风格"><a href="#五、RESTful设计风格" class="headerlink" title="五、RESTful设计风格"></a>五、RESTful设计风格</h2><p>为了简化开发流程,使开发更加直观,解读更加容易,现在有一种非常流行的程序设计风格—-&gt;RESTful设计风格</p>
<p>RESTful设计风格:<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">    主要用于后端开发,主要的表现形式为使用同一个 URL,不同的 HTTP 访问方法,表达不同的语义.</div><div class="line">&#123;</div><div class="line">    示例: http:/\/\www.xxx.com/product/<span class="number">123</span></div><div class="line">    </div><div class="line">    -GET http:/\/\www.xxx.com/product/<span class="number">123</span>   语义:从服务器<span class="string">"获取"</span>产品ID 为<span class="number">123</span>的产品信息.</div><div class="line">    </div><div class="line">    -POST http:/\/\www.xxx.com/product/<span class="number">123</span>   语义:在服务器<span class="string">"新增"</span>产品ID 为<span class="number">123</span>的产品信息.</div><div class="line">    </div><div class="line">    * 提交二进制数据,需要提交一个 JSON 格式的二进制数据,后端程序员可以直接反序列化,得到 JSON 中得字典信息.</div><div class="line">    * POST JSON</div><div class="line"></div><div class="line">    -PUT http:/\/\www.xxx.com/product/<span class="number">123</span>   语义:在服务器<span class="string">"修改"</span>产品ID 为<span class="number">123</span>的产品信息.</div><div class="line"></div><div class="line">    -DELETE http:/\/\www.xxx.com/product/<span class="number">123</span>   语义:从服务器<span class="string">"删除"</span>产品ID 为<span class="number">123</span>的产品信息.</div><div class="line"></div><div class="line">    RESTful设计风格目前在国际上非常流行,国内也逐渐开始普及.</div><div class="line">    </div><div class="line">    作为前端程序员,只需要知道有这种设计风格就可以.</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="六、AFN-上传文件"><a href="#六、AFN-上传文件" class="headerlink" title="六、AFN 上传文件"></a>六、AFN 上传文件</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="comment">// 1. 创建管理者</span></div><div class="line">    AFHTTPRequestOperationManager *mgr = [AFHTTPRequestOperationManager manager];</div><div class="line">    </div><div class="line">    <span class="comment">// 2. 发送请求</span></div><div class="line">    [mgr POST:<span class="string">@"http://localhost/upload/upload.php"</span> parameters:<span class="literal">nil</span> constructingBodyWithBlock:^(<span class="keyword">id</span>&lt;AFMultipartFormData&gt; formData) &#123;</div><div class="line">    </div><div class="line">        <span class="comment">// formData :设置上传文件所需要的参数,两种上传方法:</span></div><div class="line">        <span class="comment">// &lt;1&gt; 通过本地文件的 url 上传</span></div><div class="line">        &#123;</div><div class="line">            <span class="built_in">NSString</span> *fromFile = <span class="string">@"/Users/likaining/Desktop/meinv.jpg"</span>;</div><div class="line">            </div><div class="line">            <span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:<span class="string">@"file:///Users/likaining/Desktop/meinv.jpg"</span>];</div><div class="line">            <span class="comment">// url :需要上传文件的文件路径</span></div><div class="line">            <span class="comment">// name :服务器接收的文件名.</span></div><div class="line">            <span class="comment">// fileName: 文件在服务器中保存的名字</span></div><div class="line">            <span class="comment">// mimeType : 文件类型</span></div><div class="line">            [formData appendPartWithFileURL:url name:<span class="string">@"userfile"</span> fileName:<span class="string">@"meinv"</span> mimeType:<span class="string">@"image/jpg"</span> error:<span class="literal">NULL</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// &lt;2&gt; 通过文件的 二进制数据 上传</span></div><div class="line">        &#123;</div><div class="line">            <span class="built_in">NSData</span> *data = [<span class="built_in">NSData</span> dataWithContentsOfFile:zipFile];</div><div class="line">            </div><div class="line">            [formData appendPartWithFileData:data name:<span class="string">@"userfile"</span> fileName:<span class="string">@"meinv.zip"</span> mimeType:<span class="string">@"gzip"</span>];</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        &#125; success:^(AFHTTPRequestOperation *operation, <span class="keyword">id</span> responseObject) &#123;</div><div class="line">            <span class="comment">// 上传成功之后的回调</span></div><div class="line">            <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,responseObject);</div><div class="line">        </div><div class="line">        &#125; failure:^(AFHTTPRequestOperation *operation, <span class="built_in">NSError</span> *error) &#123;</div><div class="line">            <span class="comment">//  上传失败之后的回调</span></div><div class="line">            <span class="built_in">NSLog</span>(<span class="string">@"失败"</span>);</div><div class="line">    &#125;];</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="七、监测网络状态"><a href="#七、监测网络状态" class="headerlink" title="七、监测网络状态"></a>七、监测网络状态</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="number">1.</span> AFN 监测网络状态</div><div class="line">    &#123;</div><div class="line">        <span class="comment">// 创建 网络状态管理者</span></div><div class="line">        AFNetworkReachabilityManager *mgr = [AFNetworkReachabilityManager sharedManager];</div><div class="line">        </div><div class="line">        <span class="comment">// 监测网络状态的改变</span></div><div class="line">        [mgr setReachabilityStatusChangeBlock:^(AFNetworkReachabilityStatus status) &#123;</div><div class="line">            <span class="comment">// 当网络状态发生改变的时候调用这个block</span></div><div class="line">            <span class="keyword">switch</span> (status) &#123;</div><div class="line">                <span class="keyword">case</span> AFNetworkReachabilityStatusReachableViaWiFi:</div><div class="line">                    <span class="built_in">NSLog</span>(<span class="string">@"WIFI网络"</span>);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                    </div><div class="line">                <span class="keyword">case</span> AFNetworkReachabilityStatusReachableViaWWAN:</div><div class="line">                    <span class="built_in">NSLog</span>(<span class="string">@"蜂窝网络"</span>);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                    </div><div class="line">                <span class="keyword">case</span> AFNetworkReachabilityStatusNotReachable:</div><div class="line">                    <span class="built_in">NSLog</span>(<span class="string">@"没有网络"</span>);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                    </div><div class="line">                <span class="keyword">case</span> AFNetworkReachabilityStatusUnknown:</div><div class="line">                    <span class="built_in">NSLog</span>(<span class="string">@"未知网络"</span>);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">default</span>:</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;];</div><div class="line">        <span class="comment">// 开始监控</span></div><div class="line">        [mgr startMonitoring];</div><div class="line">    &#125;</div><div class="line">    <span class="number">2.</span>Reachability 监测网络状态</div><div class="line">    &#123;</div><div class="line">        <span class="comment">// 注册通知观察者,网络状态改变时,接收通知!</span></div><div class="line">        [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(InternetStatusChanged) name:kReachabilityChangedNotification object:<span class="literal">nil</span>];</div><div class="line"></div><div class="line">        <span class="comment">// 控制器销毁时,移除通知观察者.</span></div><div class="line">        -(<span class="keyword">void</span>)dealloc</div><div class="line">        &#123;</div><div class="line">            [[<span class="built_in">NSNotificationCenter</span> defaultCenter] removeObserver:<span class="keyword">self</span>];</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">// 根据当前网络状态,做出不同的响应.</span></div><div class="line">        - (<span class="keyword">void</span>)InternetStatusChanged</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">NSLog</span>(<span class="string">@"网络状态改变了"</span>);</div><div class="line">            </div><div class="line">            <span class="keyword">if</span> ([Reachability reachabilityForLocalWiFi].currentReachabilityStatus == ReachableViaWiFi) &#123;</div><div class="line">                <span class="built_in">NSLog</span>(<span class="string">@"Wifi 网络"</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> ([Reachability reachabilityForInternetConnection].currentReachabilityStatus == ReachableViaWWAN) &#123;</div><div class="line">                <span class="built_in">NSLog</span>(<span class="string">@"蜂窝移动网络"</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> ([Reachability reachabilityForInternetConnection].currentReachabilityStatus == NotReachable)</div><div class="line">            &#123;</div><div class="line">                <span class="built_in">NSLog</span>(<span class="string">@"没有网络"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 创建 Reachability 对象,开始监测网络状态的改变</span></div><div class="line">        - (<span class="keyword">void</span>)MonitorInternetStatus</div><div class="line">        &#123;</div><div class="line">            Reachability *CZReachability = [Reachability reachabilityForInternetConnection];</div><div class="line">            </div><div class="line">            [CZReachability startNotifier];</div><div class="line">            </div><div class="line">            <span class="keyword">self</span>.reachability = CZReachability;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        - (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">        &#123;</div><div class="line">            [<span class="keyword">self</span> MonitorInternetStatus];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/08/CoreAnimation（核心动画）/" itemprop="url">
                  CoreAnimation（核心动画）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-08T10:31:23+08:00" content="2016-07-08">
              2016-07-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/提高篇/" itemprop="url" rel="index">
                    <span itemprop="name">提高篇</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、核心动画-简介"><a href="#一、核心动画-简介" class="headerlink" title="一、核心动画(简介)"></a>一、核心动画(简介)</h2><ul>
<li>Core Animation的动画执行过程都是在后台操作的，不会阻塞主线程。</li>
<li><strong>要注意的是，Core Animation是直接作用在CALayer上的，并非UIView。</strong></li>
</ul>
<h4 id="1、动画使用步骤"><a href="#1、动画使用步骤" class="headerlink" title="1、动画使用步骤"></a>1、动画使用步骤</h4><ol>
<li>创建动画对象</li>
<li>设置动画属性</li>
<li>把动画对象添加到某个 CALayer 对象上</li>
<li>需要停止动画：可以调用 remove 方法移除动画</li>
</ol>
<h4 id="2、Core-Animation的使用步骤"><a href="#2、Core-Animation的使用步骤" class="headerlink" title="2、Core Animation的使用步骤"></a>2、Core Animation的使用步骤</h4><ol>
<li><p>使用它需要先添加QuartzCore.framework框架和引入主头文件<quartzcore quartzcore.h="">(iOS7+不需要)</quartzcore></p>
</li>
<li><p>初始化一个CAAnimation对象，并设置一些动画相关属性</p>
</li>
<li><p>通过调用CALayer的addAnimation:forKey:方法增加CAAnimation对象到CALayer中，这样就能开始执行动画了</p>
</li>
<li><p>通过调用CALayer的removeAnimationForKey:方法可以停止CALayer中的动画</p>
</li>
</ol>
<h4 id="3、注意：（问题）"><a href="#3、注意：（问题）" class="headerlink" title="3、注意：（问题）"></a>3、注意：（问题）</h4><h6 id="1、动画太快-默认时间是0-25秒-通过-duration-属性修改"><a href="#1、动画太快-默认时间是0-25秒-通过-duration-属性修改" class="headerlink" title="1、动画太快, 默认时间是0.25秒, 通过 duration 属性修改"></a>1、动画太快, 默认时间是0.25秒, 通过 duration 属性修改</h6><h6 id="2、动画执行完毕以后回到了起始的位置。"><a href="#2、动画执行完毕以后回到了起始的位置。" class="headerlink" title="2、动画执行完毕以后回到了起始的位置。"></a>2、动画执行完毕以后回到了起始的位置。</h6><ul>
<li>原因:<ul>
<li>核心动画的本质是在后台移动图层中的内容, 控件本身的 frame 没有发生改变。</li>
<li>所以看到动画执行完毕后, 又回到了原来的位置</li>
<li>通过设置动画代理来观察动画执行完毕后控件的 frame 值, layer 的 Frame 值, layer 的 position 值, 都是没有变化的</li>
</ul>
</li>
<li><p>解决:</p>
<ul>
<li><p><strong>解决1：</strong>当动画执行完毕以后, 手动设置控件的位置。在动画的代理方法（动画结束的时候设置控件的 center）</p>
<pre><code>self.blueView.center = CGPointMake(300, 50);
</code></pre><p><strong>注意: 不指定 fromValue 的情况下, 如果直接在添加完毕动画后, 设置控件的 center = 最终的终点有问题!!!所以不要在添加完动画以后直接设置 center 为最终的终点, 而要放到代理方法中。</strong></p>
<ul>
<li><p><strong>解决2：</strong></p>
<ul>
<li>动画执行完毕后不要删除动画对象</li>
<li><p>设置 fillMode</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 当动画执行完毕后不要删除动画对象</span></div><div class="line">animation.removedOnCompletion = <span class="literal">NO</span>;</div><div class="line">animation.fillMode = kCAFillModeForwards;</div></pre></td></tr></table></figure>
</li>
<li><p>缺点： 无法与用户交互, 因为 frame 就没变</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>核心动画的本质：在后台移动图层中的内容,  执行完毕后图层本身的位置并没有发生变化。</li>
</ul>
<h4 id="4、CAAnimation"><a href="#4、CAAnimation" class="headerlink" title="4、CAAnimation"></a>4、CAAnimation</h4><h6 id="1、所有动画对象的父类，负责控制动画的持续时间和速度，是个抽象类，不能直接使用，应该使用它具体的子类"><a href="#1、所有动画对象的父类，负责控制动画的持续时间和速度，是个抽象类，不能直接使用，应该使用它具体的子类" class="headerlink" title="1、所有动画对象的父类，负责控制动画的持续时间和速度，是个抽象类，不能直接使用，应该使用它具体的子类"></a>1、所有动画对象的父类，负责控制动画的持续时间和速度，是个抽象类，不能直接使用，应该使用它具体的子类</h6><h6 id="2、属性解析：-红色代表来自CAMediaTiming协议的属性"><a href="#2、属性解析：-红色代表来自CAMediaTiming协议的属性" class="headerlink" title="2、属性解析：(红色代表来自CAMediaTiming协议的属性)"></a>2、属性解析：(红色代表来自CAMediaTiming协议的属性)</h6><ul>
<li>duration：动画的持续时间</li>
<li>repeatCount：动画的重复次数</li>
<li>repeatDuration：动画的重复时间</li>
<li>removedOnCompletion：默认为YES，代表动画执行完毕后就从图层上移除，图形会恢复到动画执行前的状态。如果想让图层保持显示动画执行后的状态，那就设置为NO，不过还要设置fillMode为kCAFillModeForwards</li>
<li>fillMode：决定当前对象在非active时间段的行为.比如动画开始之前,动画结束之后</li>
<li>beginTime：可以用来设置动画延迟执行时间，若想延迟2s，就设置为* CACurrentMediaTime()+2，CACurrentMediaTime()为图层的当前时间</li>
<li>timingFunction：速度控制函数，控制动画运行的节奏</li>
<li>delegate：动画代理<h4 id="5、CAPropertyAnimation"><a href="#5、CAPropertyAnimation" class="headerlink" title="5、CAPropertyAnimation"></a>5、CAPropertyAnimation</h4></li>
<li>是CAAnimation的子类，也是个抽象类，要想创建动画对象，应该使用它的两个子类：CABasicAnimation和CAKeyframeAnimation<br>属性解析：</li>
<li>keyPath：通过指定CALayer的一个属性名称为keyPath(NSString类型)，并且对CALayer的这个属性的值进行修改，达到相应的动画效果。比如，指定@”position”为keyPath，就修改CALayer的position属性的值，以达到平移的动画效果</li>
</ul>
<h2 id="二、动画"><a href="#二、动画" class="headerlink" title="二、动画"></a>二、动画</h2><h4 id="1、CABasicAnimation-基本动画-只有两帧的动画"><a href="#1、CABasicAnimation-基本动画-只有两帧的动画" class="headerlink" title="1、CABasicAnimation(基本动画-只有两帧的动画)"></a>1、CABasicAnimation(基本动画-只有两帧的动画)</h4><ul>
<li>1、CAPropertyAnimation的子类</li>
<li>2、属性解析:<ul>
<li>fromValue：keyPath相应属性的初始值</li>
<li>toValue：keyPath相应属性的结束值</li>
</ul>
</li>
<li>3、随着动画的进行，在长度为duration的持续时间内，keyPath相应属性的值从fromValue渐渐地变为toValue</li>
</ul>
<p><strong>如果fillMode=kCAFillModeForwards和removedOnComletion=NO，那么在动画执行完毕后，图层会保持显示动画执行后的状态。但在实质上，图层的属性值还是动画执行前的初始值，并没有真正被改变。比如，CALayer的position初始值为(0,0)，CABasicAnimation的fromValue为(10,10)，toValue为(100,100)，虽然动画执行完毕后图层保持在(100,100)这个位置，实质上图层的position还是为(0,0)</strong></p>
<h4 id="2、CAAnimationGroup"><a href="#2、CAAnimationGroup" class="headerlink" title="2、CAAnimationGroup"></a>2、CAAnimationGroup</h4><ul>
<li>CAAnimation的子类，可以保存一组动画对象，将CAAnimationGroup对象加入层后，组中所有动画对象可以同时并发运行<br>属性解析：</li>
<li>animations：用来保存一组动画对象的NSArray</li>
<li>默认情况下，一组动画对象是同时运行的，也可以通过设置动画对象的beginTime属性来更改动画的开始时间</li>
</ul>
<h4 id="3、CATransition-转场动画"><a href="#3、CATransition-转场动画" class="headerlink" title="3、CATransition-转场动画"></a>3、CATransition-转场动画</h4><ul>
<li>CAAnimation的子类，用于做转场动画，能够为层提供移出屏幕和移入屏幕的动画效果。iOS比Mac OS X的转场动画效果少一点</li>
<li>UINavigationController就是通过CATransition实现了将控制器的视图推入屏幕的动画效果</li>
<li>属性解析:<ul>
<li>type：动画过渡类型</li>
<li>subtype：动画过渡方向</li>
<li>startProgress：动画起点(在整体动画的百分比)</li>
<li>endProgress：动画终点(在整体动画的百分比)</li>
</ul>
</li>
</ul>
<h6 id="1、使用UIView动画函数实现转场动画——单视图"><a href="#1、使用UIView动画函数实现转场动画——单视图" class="headerlink" title="1、使用UIView动画函数实现转场动画——单视图"></a>1、使用UIView动画函数实现转场动画——单视图</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">void</span>)transitionWithView:(<span class="built_in">UIView</span> *)view duration:(<span class="built_in">NSTimeInterval</span>)duration options:(<span class="built_in">UIViewAnimationOptions</span>)options animations:(<span class="keyword">void</span> (^)(<span class="keyword">void</span>))animations completion:(<span class="keyword">void</span> (^)(<span class="built_in">BOOL</span> finished))completion;</div></pre></td></tr></table></figure>
<p><strong>参数说明：</strong><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">duration：动画的持续时间</div><div class="line">view：需要进行转场动画的视图</div><div class="line">options：转场动画的类型</div><div class="line">animations：将改变视图属性的代码放在这个block中</div><div class="line">completion：动画结束后，会自动调用这个block</div><div class="line">```		</div><div class="line"><span class="meta">###### 2、使用UIView动画函数实现转场动画——双视图</span></div><div class="line">```objc</div><div class="line">+ (<span class="keyword">void</span>)transitionFromView:(<span class="built_in">UIView</span> *)fromView toView:(<span class="built_in">UIView</span> *)toView duration:(<span class="built_in">NSTimeInterval</span>)duration options:(<span class="built_in">UIViewAnimationOptions</span>)options completion:(<span class="keyword">void</span> (^)(<span class="built_in">BOOL</span> finished))completion;</div></pre></td></tr></table></figure></p>
<p><strong>参数说明：</strong><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">duration：动画的持续时间</div><div class="line">options：转场动画的类型</div><div class="line">animations：将改变视图属性的代码放在这个block中</div><div class="line">completion：动画结束后，会自动调用这个block</div></pre></td></tr></table></figure></p>
<h2 id="三、CADisplayLink"><a href="#三、CADisplayLink" class="headerlink" title="三、CADisplayLink"></a>三、CADisplayLink</h2><ul>
<li>CADisplayLink是一种以屏幕刷新频率触发的时钟机制，每秒钟执行大约60次左右</li>
<li>CADisplayLink是一个计时器，可以使绘图代码与视图的刷新频率保持同步，而NSTimer无法确保计时器实际被触发的准确时间</li>
<li>使用方法：<ul>
<li>定义CADisplayLink并制定触发调用方法</li>
<li>将显示链接添加到主运行循环队列</li>
</ul>
</li>
</ul>
<h4 id="4、UIView动画"><a href="#4、UIView动画" class="headerlink" title="4、UIView动画"></a>4、UIView动画</h4><p><strong>常见方法解析:</strong><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">void</span>)setAnimationDelegate:(<span class="keyword">id</span>)delegate</div><div class="line">设置动画代理对象，当动画开始或者结束时会发消息给代理对象</div><div class="line">+ (<span class="keyword">void</span>)setAnimationWillStartSelector:(SEL)selector</div><div class="line">当动画即将开始时，执行delegate对象的selector，并且把beginAnimations:context:中传入的参数传进selector</div><div class="line">+ (<span class="keyword">void</span>)setAnimationDidStopSelector:(SEL)selector</div><div class="line">当动画结束时，执行delegate对象的selector，并且把beginAnimations:context:中传入的参数传进selector</div><div class="line">+ (<span class="keyword">void</span>)setAnimationDuration:(<span class="built_in">NSTimeInterval</span>)duration</div><div class="line">动画的持续时间，秒为单位</div><div class="line">+ (<span class="keyword">void</span>)setAnimationDelay:(<span class="built_in">NSTimeInterval</span>)delay</div><div class="line">动画延迟delay秒后再开始</div><div class="line">+ (<span class="keyword">void</span>)setAnimationStartDate:(<span class="built_in">NSDate</span> *)startDate</div><div class="line">动画的开始时间，默认为now</div><div class="line">+ (<span class="keyword">void</span>)setAnimationCurve:(<span class="built_in">UIViewAnimationCurve</span>)curve</div><div class="line">动画的节奏控制,具体看下面的”备注”</div><div class="line">+ (<span class="keyword">void</span>)setAnimationRepeatCount:(<span class="keyword">float</span>)repeatCount</div><div class="line">动画的重复次数</div><div class="line">+ (<span class="keyword">void</span>)setAnimationRepeatAutoreverses:(<span class="built_in">BOOL</span>)repeatAutoreverses</div><div class="line">如果设置为<span class="literal">YES</span>,代表动画每次重复执行的效果会跟上一次相反</div><div class="line">+ (<span class="keyword">void</span>)setAnimationTransition:(<span class="built_in">UIViewAnimationTransition</span>)transition forView:(<span class="built_in">UIView</span> *)view cache:(<span class="built_in">BOOL</span>)cache</div><div class="line">设置视图view的过渡效果, transition指定过渡类型, cache设置<span class="literal">YES</span>代表使用视图缓存，性能较好</div></pre></td></tr></table></figure></p>
<h4 id="5、UIImageView的帧动画"><a href="#5、UIImageView的帧动画" class="headerlink" title="5、UIImageView的帧动画"></a>5、UIImageView的帧动画</h4><ul>
<li>UIImageView可以让一系列的图片在特定的时间内按顺序显示</li>
<li><p>相关属性解析:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">animationImages：要显示的图片(一个装着<span class="built_in">UIImage</span>的<span class="built_in">NSArray</span>)</div><div class="line">animationDuration：完整地显示一次animationImages中的所有图片所需的时间</div><div class="line">animationRepeatCount：动画的执行次数(默认为<span class="number">0</span>，代表无限循环)</div></pre></td></tr></table></figure>
</li>
<li><p>相关方法解析:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)startAnimating; 开始动画</div><div class="line">- (<span class="keyword">void</span>)stopAnimating;  停止动画</div><div class="line">- (<span class="built_in">BOOL</span>)isAnimating;  是否正在运行动画</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="6、UIActivityIndicatorView"><a href="#6、UIActivityIndicatorView" class="headerlink" title="6、UIActivityIndicatorView"></a>6、UIActivityIndicatorView</h4><ul>
<li>是一个旋转进度轮，可以用来告知用户有一个操作正在进行中，一般用initWithActivityIndicatorStyle初始化</li>
<li><p>方法解析:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)startAnimating; 开始动画</div><div class="line">- (<span class="keyword">void</span>)stopAnimating;  停止动画</div><div class="line">- (<span class="built_in">BOOL</span>)isAnimating;  是否正在运行动画</div></pre></td></tr></table></figure>
</li>
<li><p>UIActivityIndicatorViewStyle有3个值可供选择：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UIActivityIndicatorViewStyleWhiteLarge</span>   <span class="comment">//大型白色指示器    </span></div><div class="line"><span class="built_in">UIActivityIndicatorViewStyleWhite</span>      <span class="comment">//标准尺寸白色指示器    </span></div><div class="line"><span class="built_in">UIActivityIndicatorViewStyleGray</span>    <span class="comment">//灰色指示器，用于白色背景</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="四、参考代码"><a href="#四、参考代码" class="headerlink" title="四、参考代码"></a>四、参考代码</h2><h4 id="基本动画-位移"><a href="#基本动画-位移" class="headerlink" title="基本动画: 位移"></a>基本动画: 位移</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1. 创建动画对象</span></div><div class="line"><span class="built_in">CABasicAnimation</span> *animation = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"position"</span>];</div><div class="line"><span class="comment">// 默认动画时间是0.25秒</span></div><div class="line">animation.duration = <span class="number">2.0</span>;</div><div class="line"><span class="comment">// 设置动画代理</span></div><div class="line">animation.delegate = <span class="keyword">self</span>;</div><div class="line"></div><div class="line"><span class="comment">// 当动画执行完毕后不要删除动画对象</span></div><div class="line">animation.removedOnCompletion = <span class="literal">NO</span>;</div><div class="line">animation.fillMode = kCAFillModeForwards;</div><div class="line"></div><div class="line"><span class="comment">// 2. 设置动画属性值</span></div><div class="line"><span class="comment">//animation.fromValue = [NSValue valueWithCGPoint:CGPointMake(200, 30)];</span></div><div class="line">animation.fromValue = [<span class="built_in">NSValue</span> valueWithCGPoint:<span class="keyword">self</span>.blueView.center];</div><div class="line">animation.toValue = [<span class="built_in">NSValue</span> valueWithCGPoint:<span class="built_in">CGPointMake</span>(<span class="number">240</span>, <span class="number">500</span>)];</div><div class="line"><span class="comment">// 3. 将动画添加到对应的layer 中</span></div><div class="line"><span class="comment">// 这样每次会添加一个新的动画</span></div><div class="line"> <span class="comment">//self.blueView.layer addAnimation:animation forKey:nil]</span></div><div class="line"> <span class="comment">// 注意： 如果下面的 key 指定了一个写死的 key,@"animation100"，这样不会每次都添加一个新的动画了。</span></div><div class="line">[<span class="keyword">self</span>.blueView.layer addAnimation:animation forKey:<span class="string">@"animation1"</span>];</div><div class="line"><span class="comment">// 动画执行完毕后设置控件的 center</span></div><div class="line"><span class="comment">//self.blueView.center = CGPointMake(300, 50);</span></div></pre></td></tr></table></figure>
<h4 id="2、基本动画-缩放动画"><a href="#2、基本动画-缩放动画" class="headerlink" title="2、基本动画: 缩放动画"></a>2、基本动画: 缩放动画</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 创建动画对象</span></div><div class="line"><span class="built_in">CABasicAnimation</span> *anim = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"transform.scale"</span>];</div><div class="line"><span class="comment">// 设置动画属性</span></div><div class="line">anim.fromValue = @(<span class="number">1.0</span>f);</div><div class="line">anim.toValue = @(<span class="number">0.7</span>f);</div><div class="line"><span class="comment">// 设置重复次数</span></div><div class="line">anim.repeatCount = <span class="number">10</span>;</div><div class="line"></div><div class="line"><span class="comment">// 将动画对象添加到 layer 中</span></div><div class="line">[<span class="keyword">self</span>.blueView.layer addAnimation:anim forKey:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<h4 id="3、基本动画-旋转动画"><a href="#3、基本动画-旋转动画" class="headerlink" title="3、基本动画: 旋转动画"></a>3、基本动画: 旋转动画</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CABasicAnimation</span> *anim = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"transform.rotation"</span>];</div><div class="line"></div><div class="line">anim.duration = <span class="number">3</span>;</div><div class="line">anim.repeatCount = <span class="built_in">CGFLOAT_MAX</span>;</div><div class="line"><span class="comment">// 不要每次都设置起始度数</span></div><div class="line"><span class="comment">//anim.fromValue = @(0);</span></div><div class="line">anim.toValue = @(M_PI * <span class="number">2</span>);</div><div class="line"></div><div class="line">[<span class="keyword">self</span>.blueView.layer addAnimation:anim forKey:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<h6 id="一些问题："><a href="#一些问题：" class="headerlink" title="一些问题："></a>一些问题：</h6><p><strong>1、注意: 如果 [self.blueView.layer addAnimation:anim forKey:nil];没有指定 forKey, 那么每次都会添加一个新动画, 会越来越快</strong></p>
<h6 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 判断如果已经有动画对象了, 就不再添加了</span></div><div class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.blueView.layer animationForKey:<span class="string">@"anim1"</span>] != <span class="literal">nil</span>) &#123;</div><div class="line"><span class="keyword">return</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>2、注意: 如果当动画正在执行的时候, 将程序退出到后台, 那么当程序再次进入前台的时候就不执行了。</strong></p>
<h6 id="解决办法-1"><a href="#解决办法-1" class="headerlink" title="解决办法"></a>解决办法</h6><ul>
<li>原因: 因为再次进入前台后动画已经被删除了。</li>
<li>解决1: anim.removedOnCompletion = NO;</li>
</ul>
<p><strong>3、问题: 当双击 home 键的时候, 动画不会暂停。</strong></p>
<h6 id="解决办法-2"><a href="#解决办法-2" class="headerlink" title="解决办法"></a>解决办法</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 暂停</span></div><div class="line">- (<span class="keyword">void</span>)applicationWillResignActive:(<span class="built_in">UIApplication</span> *)application &#123;</div><div class="line">ViewController *vc =  (ViewController *)<span class="keyword">self</span>.window.rootViewController;</div><div class="line">[vc pause];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 恢复</span></div><div class="line">- (<span class="keyword">void</span>)applicationDidBecomeActive:(<span class="built_in">UIApplication</span> *)application &#123;</div><div class="line">ViewController *vc =  (ViewController *)<span class="keyword">self</span>.window.rootViewController;</div><div class="line">[vc resume];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="4、基本动画-关键帧动画"><a href="#4、基本动画-关键帧动画" class="headerlink" title="4、基本动画: 关键帧动画"></a>4、基本动画: 关键帧动画</h4><h6 id="1、设置-values-属性"><a href="#1、设置-values-属性" class="headerlink" title="1、设置 values 属性"></a>1、设置 values 属性</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CAKeyframeAnimation</span> *anim = [<span class="built_in">CAKeyframeAnimation</span> animationWithKeyPath:<span class="string">@"position"</span>];</div><div class="line">anim.duration = <span class="number">3</span>;</div><div class="line">anim.removedOnCompletion = <span class="literal">NO</span>;</div><div class="line"><span class="built_in">CGPoint</span> p1 = <span class="built_in">CGPointMake</span>(<span class="number">10</span>, <span class="number">10</span>);</div><div class="line"><span class="built_in">CGPoint</span> p2 = <span class="built_in">CGPointMake</span>(<span class="number">10</span>, <span class="number">110</span>);</div><div class="line"><span class="built_in">CGPoint</span> p3 = <span class="built_in">CGPointMake</span>(<span class="number">110</span>, <span class="number">110</span>);</div><div class="line"><span class="built_in">CGPoint</span> p4 = <span class="built_in">CGPointMake</span>(<span class="number">110</span>, <span class="number">10</span>);</div><div class="line"><span class="built_in">CGPoint</span> p5 = <span class="built_in">CGPointMake</span>(<span class="number">10</span>, <span class="number">10</span>);</div><div class="line">anim.values = @[[<span class="built_in">NSValue</span> valueWithCGPoint:p1], [<span class="built_in">NSValue</span> valueWithCGPoint:p2], [<span class="built_in">NSValue</span> valueWithCGPoint:p3], [<span class="built_in">NSValue</span> valueWithCGPoint:p4],[<span class="built_in">NSValue</span> valueWithCGPoint:p5]];</div><div class="line"></div><div class="line">[<span class="keyword">self</span>.blueView.layer addAnimation:anim forKey:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<h6 id="2、设置-path-属性"><a href="#2、设置-path-属性" class="headerlink" title="2、设置 path 属性"></a>2、设置 path 属性</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CAKeyframeAnimation</span> *anim = [<span class="built_in">CAKeyframeAnimation</span> animationWithKeyPath:<span class="string">@"position"</span>];</div><div class="line">anim.duration = <span class="number">3</span>;</div><div class="line">anim.removedOnCompletion = <span class="literal">NO</span>;</div><div class="line">anim.fillMode = kCAFillModeForwards;</div><div class="line"><span class="built_in">UIBezierPath</span> *path = [<span class="built_in">UIBezierPath</span> bezierPathWithOvalInRect:<span class="built_in">CGRectMake</span>(<span class="number">50</span>, <span class="number">50</span>, <span class="number">150</span>, <span class="number">150</span>)];</div><div class="line">anim.path = path.CGPath;</div><div class="line"></div><div class="line">[<span class="keyword">self</span>.blueView.layer addAnimation:anim forKey:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<h6 id="3、-模拟”app-抖动”"><a href="#3、-模拟”app-抖动”" class="headerlink" title="3、 模拟”app 抖动”"></a>3、 模拟”app 抖动”</h6><p><strong>思路: 通过设置左右旋转实现</strong><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.blueView.layer animationForKey:<span class="string">@"shake"</span>]) &#123;</div><div class="line"><span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">CAKeyframeAnimation</span> *anim = [<span class="built_in">CAKeyframeAnimation</span> animationWithKeyPath:<span class="string">@"transform.rotation"</span>];</div><div class="line">anim.values = @[@(-M_PI / <span class="number">36</span>), @(M_PI / <span class="number">36</span>), @(-M_PI / <span class="number">36</span>)];</div><div class="line">anim.duration = <span class="number">0.15</span>;</div><div class="line">anim.repeatCount = <span class="built_in">CGFLOAT_MAX</span>;</div><div class="line">[<span class="keyword">self</span>.blueView.layer addAnimation:anim forKey:<span class="string">@"shake"</span>];</div></pre></td></tr></table></figure></p>
<h4 id="5、组动画"><a href="#5、组动画" class="headerlink" title="5、组动画"></a>5、组动画</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 动画组, 组动画</span></div><div class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span> *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">&#123;</div><div class="line"><span class="built_in">UITouch</span> *touch = touches.anyObject;</div><div class="line"><span class="built_in">CGPoint</span> location = [touch locationInView:touch.view];</div><div class="line"></div><div class="line"></div><div class="line"><span class="built_in">CAAnimationGroup</span> *groupAnim = [[<span class="built_in">CAAnimationGroup</span> alloc] init];</div><div class="line"></div><div class="line"><span class="comment">// 位移</span></div><div class="line"><span class="built_in">CABasicAnimation</span> *anim1 = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"position"</span>];</div><div class="line">anim1.toValue = [<span class="built_in">NSValue</span> valueWithCGPoint:location];</div><div class="line"></div><div class="line"><span class="comment">// 缩放</span></div><div class="line"><span class="built_in">CABasicAnimation</span> *anim2 = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"transform.scale"</span>];</div><div class="line">anim2.toValue = @(<span class="number">0.3</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 旋转</span></div><div class="line"><span class="built_in">CABasicAnimation</span> *anim3 = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"transform.rotation"</span>];</div><div class="line">anim3.toValue = @(M_PI * <span class="number">8</span>);</div><div class="line"></div><div class="line"><span class="comment">// 关键帧动画</span></div><div class="line"><span class="built_in">CAKeyframeAnimation</span> *anim4 = [<span class="built_in">CAKeyframeAnimation</span> animationWithKeyPath:<span class="string">@"position"</span>];</div><div class="line"><span class="built_in">UIBezierPath</span> *path = [<span class="built_in">UIBezierPath</span> bezierPathWithOvalInRect:<span class="built_in">CGRectMake</span>(<span class="number">180</span>, <span class="number">150</span>, <span class="number">150</span>, <span class="number">150</span>)];</div><div class="line">anim4.path = path.CGPath;</div><div class="line"></div><div class="line">groupAnim.animations = @[anim1, anim2, anim3, anim4];</div><div class="line">groupAnim.duration = <span class="number">1.0</span>;</div><div class="line">groupAnim.repeatCount = <span class="built_in">CGFLOAT_MAX</span>;</div><div class="line"></div><div class="line">[<span class="keyword">self</span>.blueView.layer addAnimation:groupAnim forKey:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/08/常见结构体/" itemprop="url">
                  常见结构体
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-08T10:30:28+08:00" content="2016-07-08">
              2016-07-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/OC/" itemprop="url" rel="index">
                    <span itemprop="name">OC</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1、【理解】NSPoint和CGPoint的使用"><a href="#1、【理解】NSPoint和CGPoint的使用" class="headerlink" title="1、【理解】NSPoint和CGPoint的使用"></a>1、【理解】NSPoint和CGPoint的使用</h2><ul>
<li>CGPoint和NSPoint是同义的</li>
<li><p><code>typedef CGPoint NSPoint;</code></p>
 <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CGPoint</span>的定义</div><div class="line"><span class="keyword">struct</span> <span class="built_in">CGPoint</span> &#123;</div><div class="line">  <span class="built_in">CGFloat</span> x;</div><div class="line">  <span class="built_in">CGFloat</span> y;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="built_in">CGPoint</span> <span class="built_in">CGPoint</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> <span class="built_in">CGFloat</span>;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><code>CGPoint代表的是二维平面中的一个点,可以使用CGPointMake和NSMakePoint函数创建CGPoint.</code></p>
<h2 id="2、【理解】NSSize和CGSize的使用"><a href="#2、【理解】NSSize和CGSize的使用" class="headerlink" title="2、【理解】NSSize和CGSize的使用"></a>2、【理解】NSSize和CGSize的使用</h2><ul>
<li>CGSize和NSSize是同义的</li>
<li><p>typedef CGSize NSSize;</p>
 <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CGSize</span>的定义</div><div class="line"><span class="keyword">struct</span> <span class="built_in">CGSize</span> &#123;</div><div class="line">  <span class="built_in">CGFloat</span> width;</div><div class="line">  <span class="built_in">CGFloat</span> height;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="built_in">CGSize</span> <span class="built_in">CGSize</span>;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><code>CGSize代表的是二维平面中的某个物体的尺寸(宽度和高度)
可以使用CGSizeMake和NSMakeSize函数创建CGSize</code></p>
<h2 id="3、【理解】NSRect和CGRect的使用"><a href="#3、【理解】NSRect和CGRect的使用" class="headerlink" title="3、【理解】NSRect和CGRect的使用"></a>3、【理解】NSRect和CGRect的使用</h2><ul>
<li>CGRect和NSRect是同义的</li>
<li><p>typedef CGRect NSRect;</p>
 <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CGRect</span>的定义</div><div class="line"><span class="keyword">struct</span> <span class="built_in">CGRect</span> &#123;</div><div class="line">  <span class="built_in">CGPoint</span> origin;</div><div class="line">  <span class="built_in">CGSize</span> size;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="built_in">CGRect</span> <span class="built_in">CGRect</span>;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><code>CGRect代表的是二维平面中的某个物体的位置和尺寸
可以使用CGRectMake和NSMakeRect函数创建CGRect</code></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/Markdown语法/" itemprop="url">
                  Markdown语法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T20:31:08+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/随笔/" itemprop="url" rel="index">
                    <span itemprop="name">随笔</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Mou"><a href="#Mou" class="headerlink" title="Mou"></a>Mou</h1><p><img src="http://25.io/mou/Mou_128.png" alt="Mou icon"></p>
<h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p><strong>Mou</strong>, the missing Markdown editor for <em>web developers</em>.</p>
<h3 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h3><h4 id="Strong-and-Emphasize"><a href="#Strong-and-Emphasize" class="headerlink" title="Strong and Emphasize"></a>Strong and Emphasize</h4><p><strong>strong</strong> or <strong>strong</strong> ( Cmd + B )</p>
<p><em>emphasize</em> or <em>emphasize</em> ( Cmd + I )</p>
<p><strong>Sometimes I want a lot of text to be bold.<br>Like, seriously, a <em>LOT</em> of text</strong></p>
<h4 id="Blockquotes"><a href="#Blockquotes" class="headerlink" title="Blockquotes"></a>Blockquotes</h4><blockquote>
<p>Right angle brackets &gt; are used for block quotes.</p>
</blockquote>
<h4 id="Links-and-Email"><a href="#Links-and-Email" class="headerlink" title="Links and Email"></a>Links and Email</h4><p>An email <a href="&#109;&#x61;&#105;&#108;&#116;&#x6f;&#x3a;&#x65;&#x78;&#97;&#109;&#x70;&#108;&#101;&#x40;&#101;&#x78;&#97;&#x6d;&#112;&#x6c;&#101;&#x2e;&#x63;&#111;&#x6d;">&#x65;&#x78;&#97;&#109;&#x70;&#108;&#101;&#x40;&#101;&#x78;&#97;&#x6d;&#112;&#x6c;&#101;&#x2e;&#x63;&#111;&#x6d;</a> link.</p>
<p>Simple inline link <a href="http://chenluois.com" target="_blank" rel="external">http://chenluois.com</a>, another inline link <a href="http://25.io/smaller/" target="_blank" rel="external">Smaller</a>, one more inline link with title <a href="http://resizesafari.com" title="a Safari extension" target="_blank" rel="external">Resize</a>.</p>
<p>A <a href="http://25.io/mou/" title="Markdown editor on Mac OS X" target="_blank" rel="external">reference style</a> link. Input id, then anywhere in the doc, define the link with corresponding id:</p>
<p>Titles ( or called tool tips ) in the links are optional.</p>
<h4 id="Images"><a href="#Images" class="headerlink" title="Images"></a>Images</h4><p>An inline image <img src="http://25.io/smaller/favicon.ico" alt="Smaller icon" title="Title here">, title is optional.</p>
<p>A <img src="http://resizesafari.com/favicon.ico" alt="Resize icon" title="Title"> reference style image.</p>
<h4 id="Inline-code-and-Block-code"><a href="#Inline-code-and-Block-code" class="headerlink" title="Inline code and Block code"></a>Inline code and Block code</h4><p>Inline code are surround by <code>backtick</code> key. To create a block code:</p>
<pre><code>Indent each line by at least 1 tab, or 4 spaces.
var Mou = exactlyTheAppIwant; 
</code></pre><h4 id="Ordered-Lists"><a href="#Ordered-Lists" class="headerlink" title="Ordered Lists"></a>Ordered Lists</h4><p>Ordered lists are created using “1.” + Space:</p>
<ol>
<li>Ordered list item</li>
<li>Ordered list item</li>
<li>Ordered list item</li>
</ol>
<h4 id="Unordered-Lists"><a href="#Unordered-Lists" class="headerlink" title="Unordered Lists"></a>Unordered Lists</h4><p>Unordered list are created using “*” + Space:</p>
<ul>
<li>Unordered list item</li>
<li>Unordered list item</li>
<li>Unordered list item </li>
</ul>
<p>Or using “-“ + Space:</p>
<ul>
<li>Unordered list item</li>
<li>Unordered list item</li>
<li>Unordered list item</li>
</ul>
<h4 id="Hard-Linebreak"><a href="#Hard-Linebreak" class="headerlink" title="Hard Linebreak"></a>Hard Linebreak</h4><p>End a line with two or more spaces will create a hard linebreak, called <code>&lt;br /&gt;</code> in HTML. ( Control + Return )<br>Above line ended with 2 spaces.</p>
<h4 id="Horizontal-Rules"><a href="#Horizontal-Rules" class="headerlink" title="Horizontal Rules"></a>Horizontal Rules</h4><p>Three or more asterisks or dashes:</p>
<hr>
<hr>
<hr>
<h4 id="Headers"><a href="#Headers" class="headerlink" title="Headers"></a>Headers</h4><p>Setext-style:</p>
<h1 id="This-is-H1"><a href="#This-is-H1" class="headerlink" title="This is H1"></a>This is H1</h1><h2 id="This-is-H2"><a href="#This-is-H2" class="headerlink" title="This is H2"></a>This is H2</h2><p>atx-style:</p>
<h1 id="This-is-H1-1"><a href="#This-is-H1-1" class="headerlink" title="This is H1"></a>This is H1</h1><h2 id="This-is-H2-1"><a href="#This-is-H2-1" class="headerlink" title="This is H2"></a>This is H2</h2><h3 id="This-is-H3"><a href="#This-is-H3" class="headerlink" title="This is H3"></a>This is H3</h3><h4 id="This-is-H4"><a href="#This-is-H4" class="headerlink" title="This is H4"></a>This is H4</h4><h5 id="This-is-H5"><a href="#This-is-H5" class="headerlink" title="This is H5"></a>This is H5</h5><h6 id="This-is-H6"><a href="#This-is-H6" class="headerlink" title="This is H6"></a>This is H6</h6><h3 id="Extra-Syntax"><a href="#Extra-Syntax" class="headerlink" title="Extra Syntax"></a>Extra Syntax</h3><h4 id="Footnotes"><a href="#Footnotes" class="headerlink" title="Footnotes"></a>Footnotes</h4><p>Footnotes work mostly like reference-style links. A footnote is made of two things: a marker in the text that will become a superscript number; a footnote definition that will be placed in a list of footnotes at the end of the document. A footnote looks like this:</p>
<p>That’s some text with a footnote.[^1]</p>
<p>[^1]: And that’s the footnote.</p>
<h4 id="Strikethrough"><a href="#Strikethrough" class="headerlink" title="Strikethrough"></a>Strikethrough</h4><p>Wrap with 2 tilde characters:</p>
<p><del>Strikethrough</del></p>
<h4 id="Fenced-Code-Blocks"><a href="#Fenced-Code-Blocks" class="headerlink" title="Fenced Code Blocks"></a>Fenced Code Blocks</h4><p>Start with a line containing 3 or more backticks, and ends with the first line with the same number of backticks:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Fenced code blocks are like Stardard Markdown’s regular code</div><div class="line">blocks, except that they’re not indented and instead rely on</div><div class="line">a start and end fence lines to delimit the code block.</div></pre></td></tr></table></figure>
<h4 id="Tables"><a href="#Tables" class="headerlink" title="Tables"></a>Tables</h4><p>A simple table looks like this:</p>
<table>
<thead>
<tr>
<th>First Header</th>
<th>Second Header</th>
<th>Third Header</th>
</tr>
</thead>
<tbody>
<tr>
<td>Content Cell</td>
<td>Content Cell</td>
<td>Content Cell</td>
</tr>
<tr>
<td>Content Cell</td>
<td>Content Cell</td>
<td>Content Cell</td>
</tr>
</tbody>
</table>
<p>If you wish, you can add a leading and tailing pipe to each line of the table:</p>
<table>
<thead>
<tr>
<th>First Header</th>
<th>Second Header</th>
<th>Third Header</th>
</tr>
</thead>
<tbody>
<tr>
<td>Content Cell</td>
<td>Content Cell</td>
<td>Content Cell</td>
</tr>
<tr>
<td>Content Cell</td>
<td>Content Cell</td>
<td>Content Cell</td>
</tr>
</tbody>
</table>
<p>Specify alignment for each column by adding colons to separator lines:</p>
<table>
<thead>
<tr>
<th style="text-align:left">First Header</th>
<th style="text-align:center">Second Header</th>
<th style="text-align:right">Third Header</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Left</td>
<td style="text-align:center">Center</td>
<td style="text-align:right">Right</td>
</tr>
<tr>
<td style="text-align:left">Left</td>
<td style="text-align:center">Center</td>
<td style="text-align:right">Right</td>
</tr>
</tbody>
</table>
<h3 id="Shortcuts"><a href="#Shortcuts" class="headerlink" title="Shortcuts"></a>Shortcuts</h3><h4 id="View"><a href="#View" class="headerlink" title="View"></a>View</h4><ul>
<li>Toggle live preview: Shift + Cmd + I</li>
<li>Toggle Words Counter: Shift + Cmd + W</li>
<li>Toggle Transparent: Shift + Cmd + T</li>
<li>Toggle Floating: Shift + Cmd + F</li>
<li>Left/Right = 1/1: Cmd + 0</li>
<li>Left/Right = 3/1: Cmd + +</li>
<li>Left/Right = 1/3: Cmd + -</li>
<li>Toggle Writing orientation: Cmd + L</li>
<li>Toggle fullscreen: Control + Cmd + F</li>
</ul>
<h4 id="Actions"><a href="#Actions" class="headerlink" title="Actions"></a>Actions</h4><ul>
<li>Copy HTML: Option + Cmd + C</li>
<li>Strong: Select text, Cmd + B</li>
<li>Emphasize: Select text, Cmd + I</li>
<li>Inline Code: Select text, Cmd + K</li>
<li>Strikethrough: Select text, Cmd + U</li>
<li>Link: Select text, Control + Shift + L</li>
<li>Image: Select text, Control + Shift + I</li>
<li>Select Word: Control + Option + W</li>
<li>Select Line: Shift + Cmd + L</li>
<li>Select All: Cmd + A</li>
<li>Deselect All: Cmd + D</li>
<li>Convert to Uppercase: Select text, Control + U</li>
<li>Convert to Lowercase: Select text, Control + Shift + U</li>
<li>Convert to Titlecase: Select text, Control + Option + U</li>
<li>Convert to List: Select lines, Control + L</li>
<li>Convert to Blockquote: Select lines, Control + Q</li>
<li>Convert to H1: Cmd + 1</li>
<li>Convert to H2: Cmd + 2</li>
<li>Convert to H3: Cmd + 3</li>
<li>Convert to H4: Cmd + 4</li>
<li>Convert to H5: Cmd + 5</li>
<li>Convert to H6: Cmd + 6</li>
<li>Convert Spaces to Tabs: Control + [</li>
<li>Convert Tabs to Spaces: Control + ]</li>
<li>Insert Current Date: Control + Shift + 1</li>
<li>Insert Current Time: Control + Shift + 2</li>
<li>Insert entity &lt;: Control + Shift + ,</li>
<li>Insert entity &gt;: Control + Shift + .</li>
<li>Insert entity &amp;: Control + Shift + 7</li>
<li>Insert entity Space: Control + Shift + Space</li>
<li>Insert Scriptogr.am Header: Control + Shift + G</li>
<li>Shift Line Left: Select lines, Cmd + [</li>
<li>Shift Line Right: Select lines, Cmd + ]</li>
<li>New Line: Cmd + Return  </li>
<li>Comment: Cmd + /</li>
<li>Hard Linebreak: Control + Return  </li>
</ul>
<h4 id="Edit"><a href="#Edit" class="headerlink" title="Edit"></a>Edit</h4><ul>
<li>Auto complete current word: Esc</li>
<li>Find: Cmd + F</li>
<li>Close find bar: Esc</li>
</ul>
<h4 id="Post"><a href="#Post" class="headerlink" title="Post"></a>Post</h4><ul>
<li>Post on Scriptogr.am: Control + Shift + S</li>
<li>Post on Tumblr: Control + Shift + T</li>
</ul>
<h4 id="Export"><a href="#Export" class="headerlink" title="Export"></a>Export</h4><ul>
<li>Export HTML: Option + Cmd + E</li>
<li>Export PDF:  Option + Cmd + P</li>
</ul>
<h3 id="And-more"><a href="#And-more" class="headerlink" title="And more?"></a>And more?</h3><p>Don’t forget to check Preferences, lots of useful options are there.</p>
<p>Follow <a href="https://twitter.com/mou" target="_blank" rel="external">@Mou</a> on Twitter for the latest news.</p>
<p>For feedback, use the menu <code>Help</code> - <code>Send Feedback</code></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/Quartz2d(绘图)/" itemprop="url">
                  Quartz2D(绘图)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T10:31:23+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/提高篇/" itemprop="url" rel="index">
                    <span itemprop="name">提高篇</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、基本图形绘制"><a href="#一、基本图形绘制" class="headerlink" title="一、基本图形绘制"></a>一、基本图形绘制</h2><ul>
<li>线段（线宽、线段样式）</li>
<li>矩形（空心、实心、颜色）</li>
<li>三角形、四边形等形状</li>
<li>1、说明 - (void)drawRect:(CGRect)rect 什么时候调用、调用次数等<ul>
<li>当 view 第一次被显示的时候调用(调用一次)</li>
<li>或者是重绘事件被触发的时候</li>
<li>不要手动去调用这个方法</li>
</ul>
</li>
</ul>
<ul>
<li><strong>手动调用重绘方法 setNeedsDisplay 或者 setNeedsDisplayInRect:</strong><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">setNeedsDisplay 方法会把之前的内容都清除掉, 然后再重绘。</div><div class="line">setNeedsDisplayInRect:&lt;<span class="meta">#(CGRect)#&gt;局部刷新</span></div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li>2、说明为什么要在 - (void)drawRect:(CGRect)rect 方法中进行绘图</li>
<li><strong>只有在这个方法中才能获取当前 View 的绘图上下文</strong></li>
</ul>
<h4 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h4><ol>
<li>当要向UIView上绘图的时候, 必须重写UIView的drawRect:方法, 然后在这个方法中进行绘图</li>
<li>在drawRect:方法中获取的参数rect, 指的就是当前view的bounds属性</li>
<li>为什么向当前view中绘制图形, 必须在drawRect:方法中进行?<ul>
<li>3.1 原因: 只有在当前view的drawRect:方法中才能成功的获取当前view的”图形上下文”, 有了图形上下文才能进行绘图</li>
<li>3.2 为什么只有在drawRect:方法中才能获取当前view的图形上下文呢？</li>
<li>3.3 原因: 是因为系统在调用drawRect:方法之前已经帮我们创建好了一个与当前view相关的图形上下文了, 然后才调用的drawRect:方法, 所以在drawRect:方法中, 我们就可以成功获取当前view的图形上下文了。</li>
<li>3.4 如何创建一个图形上下文？（后面说）<ul>
<li>3.5 drawRect:方法是谁来调用的？什么时候调用的？<ul>
<li>3.5.1 drawRect:方法是系统帮我们调用的, 千万别手动去调用这个方法。原因是, 自己手动去调用drawRect:方法的时候无法保证系统已经帮我们创建好了”图形上下文”, 所以这样就无法保证在drawRect:方法中获取”图形上下文”对象, 所以也就无法绘图。</li>
<li>3.5.2 drawRect:方法的什么时候被调用？<ul>
<li>1&gt; 当这个View第一次显示的时候会条用一次drawRect:方法。</li>
<li>2&gt; 当这个View执行重绘操作的时候, 会重新调用drawRect:方法来进行绘图。</li>
<li>3&gt; 通过调用【[self setNeedsDisplay];// 把这个view都重绘一次】 或 【[self setNeedsDisplayInRect:(CGRect)]// 把view中的某个区域重绘一次】 来实现重绘</li>
<li>4&gt; 在每次调用 setNeedsDisplay 或 setNeedsDisplayInRect:方法的时候, 内部会先创建一个与当前view相关连的”图形上下文”然后再调用drawRect:实现重绘。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><strong>注意: UIBezierPath 对象可以独立使用,  无需手动获取“图形上下文”对象，此处为了更好的理解“图形上下文对象”所以暂时还是采用手动获取“图形上下文”对象的方式来绘图
</strong>        </p>
<h4 id="参考代码"><a href="#参考代码" class="headerlink" title="参考代码"></a>参考代码</h4><h6 id="1、绘制一个”三角形”"><a href="#1、绘制一个”三角形”" class="headerlink" title="1、绘制一个”三角形”"></a>1、绘制一个”三角形”</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1. 获取当前的图形上下文</span></div><div class="line"><span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line"><span class="comment">// 2. 在上下文中绘制图形（拼接路径）</span></div><div class="line"><span class="comment">// 2.1 设置一个起点</span></div><div class="line"><span class="built_in">CGContextMoveToPoint</span>(ctx, <span class="number">20</span>, <span class="number">20</span>);</div><div class="line"><span class="comment">// 2.2 添加一条直线到(100, 100)这个点</span></div><div class="line"><span class="built_in">CGContextAddLineToPoint</span>(ctx, <span class="number">100</span>, <span class="number">100</span>);</div><div class="line"><span class="comment">// 2.3 再添加一条线</span></div><div class="line"><span class="built_in">CGContextAddLineToPoint</span>(ctx, <span class="number">120</span>, <span class="number">30</span>);</div><div class="line"><span class="comment">// 2.4 再添加一条线段</span></div><div class="line"><span class="comment">//CGContextAddLineToPoint(ctx, 20, 20);</span></div><div class="line"><span class="comment">// 另外一种做法: 直接关闭路径（连接最后一个点和起点）</span></div><div class="line"><span class="built_in">CGContextClosePath</span>(ctx);</div><div class="line"><span class="comment">// 3. 把上下文渲染显示到 HMView01上</span></div><div class="line"><span class="comment">// StrokePath 表示把路径以空心的形式渲染出来。</span></div><div class="line"><span class="built_in">CGContextStrokePath</span>(ctx);</div></pre></td></tr></table></figure>
<h6 id="2、绘制一个实心”矩形”"><a href="#2、绘制一个实心”矩形”" class="headerlink" title="2、绘制一个实心”矩形”"></a>2、绘制一个实心”矩形”</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 绘制一个"四边形"</span></div><div class="line"><span class="comment">// 1. 获取当前图形上下文</span></div><div class="line"><span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line"><span class="comment">// 2. 开始绘制路径</span></div><div class="line"><span class="built_in">CGContextAddRect</span>(ctx, <span class="built_in">CGRectMake</span>(<span class="number">20</span>, <span class="number">20</span>, <span class="number">100</span>, <span class="number">120</span>));</div><div class="line"><span class="comment">// 3. 渲染</span></div><div class="line"><span class="built_in">CGContextFillPath</span>(ctx);</div></pre></td></tr></table></figure>
<h6 id="3、设置图形的颜色"><a href="#3、设置图形的颜色" class="headerlink" title="3、设置图形的颜色"></a>3、设置图形的颜色</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 绘制一个"四边形"</span></div><div class="line"><span class="comment">// 1. 获取当前图形上下文</span></div><div class="line"><span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line"><span class="comment">// 2. 开始绘制路径</span></div><div class="line"><span class="built_in">CGContextAddRect</span>(ctx, <span class="built_in">CGRectMake</span>(<span class="number">20</span>, <span class="number">20</span>, <span class="number">100</span>, <span class="number">120</span>));</div><div class="line"></div><div class="line"><span class="comment">//============ C 语言的方式设置颜色 =================</span></div><div class="line"><span class="built_in">CGContextSetRGBFillColor</span>(ctx, <span class="number">200</span>/<span class="number">255.0</span>, <span class="number">100</span>/<span class="number">255.0</span>, <span class="number">50</span>/<span class="number">255.0</span>, <span class="number">1.0</span>);</div><div class="line"><span class="comment">//CGContextSetRGBStrokeColor(&lt;#CGContextRef context#&gt;, &lt;#CGFloat red#&gt;, &lt;#CGFloat green#&gt;, &lt;#CGFloat blue#&gt;, &lt;#CGFloat alpha#&gt;)</span></div><div class="line"><span class="comment">//============ C 语言的方式设置颜色 =================</span></div><div class="line"></div><div class="line"><span class="comment">//============ OC 的方式设置颜色 =================</span></div><div class="line"><span class="comment">// 设置空心图形的线条颜色</span></div><div class="line"><span class="comment">// [[UIColor redColor] setStroke];</span></div><div class="line"><span class="comment">// 设置实心图形的填充颜色</span></div><div class="line"><span class="comment">// [[UIColor redColor] setFill];</span></div><div class="line"><span class="comment">// 统一设置"空心图形" 和 "实心图形"的颜色</span></div><div class="line"><span class="comment">//[[UIColor redColor] set];</span></div><div class="line"><span class="comment">//============ OC 的方式设置颜色 =================</span></div><div class="line"><span class="comment">// 3. 渲染</span></div><div class="line"><span class="built_in">CGContextFillPath</span>(ctx);</div></pre></td></tr></table></figure>
<h6 id="4、设置不同线段-不同颜色"><a href="#4、设置不同线段-不同颜色" class="headerlink" title="4、设置不同线段, 不同颜色"></a>4、设置不同线段, 不同颜色</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//画两根线, 一根红色, 一根蓝色</span></div><div class="line"><span class="comment">// 1. 获取上下文对象</span></div><div class="line"><span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line"><span class="comment">// 2. 绘制图形</span></div><div class="line"><span class="comment">// 2.1 设置起点</span></div><div class="line"><span class="built_in">CGContextMoveToPoint</span>(ctx, <span class="number">50</span>, <span class="number">50</span>);</div><div class="line"><span class="comment">// 2.2 添加一根线</span></div><div class="line"><span class="built_in">CGContextAddLineToPoint</span>(ctx, <span class="number">50</span>, <span class="number">150</span>);</div><div class="line"><span class="comment">// 2.3 设置线段颜色</span></div><div class="line">[[<span class="built_in">UIColor</span> redColor] set];</div><div class="line"><span class="comment">// 2.4 设置线宽</span></div><div class="line"><span class="built_in">CGContextSetLineWidth</span>(ctx, <span class="number">10</span>);</div><div class="line"><span class="comment">// 渲染一次</span></div><div class="line"><span class="built_in">CGContextStrokePath</span>(ctx);</div><div class="line"></div><div class="line"><span class="comment">// 再移动到一个新的起点</span></div><div class="line"><span class="built_in">CGContextMoveToPoint</span>(ctx, <span class="number">100</span>, <span class="number">50</span>);</div><div class="line"><span class="comment">// 再添加一根线</span></div><div class="line"><span class="built_in">CGContextAddLineToPoint</span>(ctx, <span class="number">100</span>, <span class="number">150</span>);</div><div class="line"><span class="comment">// 设置线的颜色</span></div><div class="line">[[<span class="built_in">UIColor</span> blueColor] set];</div><div class="line"><span class="comment">// 3. 渲染"上下文对象"到 view 上</span></div><div class="line"><span class="built_in">CGContextStrokePath</span>(ctx);</div></pre></td></tr></table></figure>
<h6 id="5、设置线段”头尾部”的样式"><a href="#5、设置线段”头尾部”的样式" class="headerlink" title="5、设置线段”头尾部”的样式"></a>5、设置线段”头尾部”的样式</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">// 1. 获取上下文对象</span></div><div class="line"> <span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line"> <span class="comment">// 2. 绘制路径</span></div><div class="line"> <span class="comment">// 2.1 移动到起点</span></div><div class="line"> <span class="built_in">CGContextMoveToPoint</span>(ctx, <span class="number">20</span>, <span class="number">20</span>);</div><div class="line"> <span class="comment">// 2.2 添加一条线段</span></div><div class="line"> <span class="built_in">CGContextAddLineToPoint</span>(ctx, <span class="number">100</span>, <span class="number">100</span>);</div><div class="line"> <span class="comment">// 2.3 设置颜色</span></div><div class="line"> [[<span class="built_in">UIColor</span> redColor] set];</div><div class="line"> <span class="comment">// 2.4 设置线段宽度</span></div><div class="line"> <span class="built_in">CGContextSetLineWidth</span>(ctx, <span class="number">15</span>);</div><div class="line"> <span class="comment">// 2.5 设置线段头尾部样式</span></div><div class="line"><span class="comment">//enum CGLineCap &#123;</span></div><div class="line"><span class="comment">//kCGLineCapButt, 默认值</span></div><div class="line"><span class="comment">//kCGLineCapRound, 圆角</span></div><div class="line"><span class="comment">//kCGLineCapSquare 方角</span></div><div class="line"><span class="comment">//&#125;;</span></div><div class="line"><span class="built_in">CGContextSetLineCap</span>(ctx, kCGLineCapSquare);</div><div class="line"><span class="comment">// 3. 渲染</span></div><div class="line"><span class="built_in">CGContextStrokePath</span>(ctx);</div></pre></td></tr></table></figure>
<h6 id="6、设置转折点样式"><a href="#6、设置转折点样式" class="headerlink" title="6、设置转折点样式"></a>6、设置转折点样式</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 2.4 设置线段宽度</span></div><div class="line"><span class="built_in">CGContextSetLineWidth</span>(ctx, <span class="number">15</span>);</div><div class="line"><span class="comment">// 2.5 设置线段头尾部样式</span></div><div class="line"><span class="built_in">CGContextSetLineCap</span>(ctx, kCGLineCapRound);</div><div class="line"><span class="comment">// 2.6 设置转折点样式</span></div><div class="line"><span class="built_in">CGContextSetLineJoin</span>(ctx, kCGLineJoinBevel);</div></pre></td></tr></table></figure>
<h6 id="7、文字绘制-通过OC-来绘制图形"><a href="#7、文字绘制-通过OC-来绘制图形" class="headerlink" title="7、文字绘制(通过OC 来绘制图形)"></a>7、文字绘制(通过OC 来绘制图形)</h6><p><strong>1、绘制一段文字(思路: 直接使用 OC 的方法, 无需手动获取上下文对象)</strong><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSString</span> *str = <span class="string">@"哈哈, 黑马程序员 iOS学院。"</span>;</div><div class="line"><span class="built_in">NSDictionary</span> *attrs = @&#123;</div><div class="line">    <span class="built_in">NSForegroundColorAttributeName</span> : [<span class="built_in">UIColor</span> redColor],</div><div class="line">    <span class="built_in">NSFontAttributeName</span> : [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">20</span>]</div><div class="line">&#125;;</div><div class="line">[str drawAtPoint:<span class="built_in">CGPointMake</span>(<span class="number">30</span>, <span class="number">50</span>) withAttributes:attrs];</div></pre></td></tr></table></figure></p>
<p><strong>2、绘制一段文字到一个指定的区域</strong></p>
<p>思路: 调用字符串的 drawInRect: 方法.<br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1. 绘制文字</span></div><div class="line"><span class="built_in">NSString</span> *str = <span class="string">@"哈哈, 黑马程序员 iOS。"</span>;</div><div class="line"><span class="built_in">NSDictionary</span> *attrs = @&#123;</div><div class="line"><span class="built_in">NSForegroundColorAttributeName</span> : [<span class="built_in">UIColor</span> redColor],</div><div class="line"><span class="built_in">NSFontAttributeName</span> : [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">20</span>]</div><div class="line">&#125;;</div><div class="line"></div><div class="line">[str drawInRect:<span class="built_in">CGRectMake</span>(<span class="number">20</span>, <span class="number">20</span>, <span class="number">50</span>, <span class="number">250</span>) withAttributes:attrs];</div><div class="line"><span class="comment">// 1. 获取上下文</span></div><div class="line"><span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line"><span class="comment">// 2. 把矩形画出来</span></div><div class="line"><span class="built_in">CGContextAddRect</span>(ctx,<span class="built_in">CGRectMake</span>(<span class="number">20</span>, <span class="number">20</span>, <span class="number">50</span>, <span class="number">250</span>));</div><div class="line"><span class="comment">// 3. 渲染</span></div><div class="line"><span class="built_in">CGContextStrokePath</span>(ctx);</div></pre></td></tr></table></figure></p>
<h6 id="8、图片绘制-通过OC-来绘制图形"><a href="#8、图片绘制-通过OC-来绘制图形" class="headerlink" title="8、图片绘制(通过OC 来绘制图形)"></a>8、图片绘制(通过OC 来绘制图形)</h6><p><strong>1、绘制一张图片到 UIView 上</strong><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1. 获取图片</span></div><div class="line"><span class="built_in">UIImage</span> *img = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"dst2"</span>];</div><div class="line"><span class="comment">// 2. 把图片画到当前的 view中</span></div><div class="line">[img drawAtPoint:<span class="built_in">CGPointMake</span>(<span class="number">0</span>, <span class="number">0</span>)];</div></pre></td></tr></table></figure></p>
<p><strong>2、在指定的矩形中绘制图片（会自动拉伸）</strong><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1. 获取图片</span></div><div class="line"><span class="built_in">UIImage</span> *img = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"dst2"</span>];</div><div class="line"><span class="comment">// 2. 把图片画到当前的 view中</span></div><div class="line">[img drawInRect:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">150</span>, <span class="number">150</span>)];</div></pre></td></tr></table></figure></p>
<p><strong>3、画格子花纹效果(（pattern）), 思路: 调用drawAsPatternInRect:方法</strong><br><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1. 获取图片</span></div><div class="line"><span class="built_in">UIImage</span> *img = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"abc"</span>];</div><div class="line"><span class="comment">// 2. 把图片画到当前的 view中</span></div><div class="line">[img drawAsPatternInRect:<span class="keyword">self</span>.bounds];</div><div class="line"><span class="comment">// 3. 在右下角显示文字</span></div><div class="line"><span class="built_in">NSString</span> *str = <span class="string">@"@Lonely ios"</span>;</div><div class="line"><span class="built_in">NSDictionary</span> *attrs = @&#123;</div><div class="line"><span class="built_in">NSForegroundColorAttributeName</span> : [<span class="built_in">UIColor</span> redColor],</div><div class="line"><span class="built_in">NSFontAttributeName</span> : [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">20</span>]</div><div class="line">&#125;;</div><div class="line">[ str drawInRect:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">100</span>, <span class="number">200</span>, <span class="number">30</span>) withAttributes:attrs];</div></pre></td></tr></table></figure></p>
<h2 id="二、图形上下文栈"><a href="#二、图形上下文栈" class="headerlink" title="二、图形上下文栈"></a>二、图形上下文栈</h2><ul>
<li><strong>CGContextSaveGState(ctx);// 保存ctx这个绘图上下文对象</strong></li>
<li><strong>CGContextRestoreGState(ctx); // 恢复 ctx这个图形上下文</strong></li>
</ul>
<h4 id="参考代码-1"><a href="#参考代码-1" class="headerlink" title="参考代码"></a>参考代码</h4><h6 id="1、矩阵操作"><a href="#1、矩阵操作" class="headerlink" title="1、矩阵操作"></a>1、矩阵操作</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1. 获取上下文</span></div><div class="line"><span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line"><span class="comment">// 保存上下文</span></div><div class="line"><span class="built_in">CGContextSaveGState</span>(ctx);</div><div class="line"><span class="comment">//======================= 矩阵操作 ============================</span></div><div class="line"><span class="comment">// 1.1 旋转</span></div><div class="line"><span class="built_in">CGContextRotateCTM</span>(ctx, M_PI_4 * <span class="number">0.5</span>);</div><div class="line"><span class="comment">// 1.2 缩放</span></div><div class="line"><span class="built_in">CGContextScaleCTM</span>(ctx, <span class="number">0.5</span>, <span class="number">0.5</span>);</div><div class="line"><span class="comment">//======================= 矩阵操作 ============================</span></div><div class="line"><span class="comment">// 2. 绘制一些图形</span></div><div class="line"><span class="built_in">CGContextMoveToPoint</span>(ctx, <span class="number">10</span>, <span class="number">10</span>);</div><div class="line"><span class="built_in">CGContextAddLineToPoint</span>(ctx, <span class="number">100</span>, <span class="number">100</span>);</div><div class="line"><span class="built_in">CGContextAddEllipseInRect</span>(ctx, <span class="built_in">CGRectMake</span>(<span class="number">130</span>, <span class="number">150</span>, <span class="number">100</span>, <span class="number">100</span>));</div><div class="line"><span class="comment">// 恢复上下文</span></div><div class="line"><span class="built_in">CGContextRestoreGState</span>(ctx);</div><div class="line"><span class="built_in">CGContextAddRect</span>(ctx, <span class="built_in">CGRectMake</span>(<span class="number">70</span>, <span class="number">90</span>, <span class="number">100</span>, <span class="number">80</span>));</div><div class="line"><span class="comment">// 3. 渲染</span></div><div class="line"><span class="built_in">CGContextStrokePath</span>(ctx);</div></pre></td></tr></table></figure>
<p><strong>注：在绘制任何图形前保存上下文, 在绘制最后一个图形前恢复上下文</strong></p>
<h6 id="2、图片裁剪"><a href="#2、图片裁剪" class="headerlink" title="2、图片裁剪"></a>2、图片裁剪</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line"><span class="comment">// 1. 画圆，这里最好使用 Ellipse 来绘制圆（画圆和画图片都从0,0点开始）。</span></div><div class="line"><span class="built_in">CGContextAddArc</span>(ctx, <span class="number">100</span>, <span class="number">100</span>, <span class="number">90</span>, <span class="number">0</span>, M_PI * <span class="number">2</span>, <span class="number">1</span>);</div><div class="line"><span class="comment">// 2. 裁剪上下文, 注意裁剪完毕就只能在裁剪好的区域内画东西了, 超出的地方无法绘制图形。</span></div><div class="line"><span class="built_in">CGContextClip</span>(ctx);</div><div class="line"><span class="comment">// 3. 把图片绘制上去</span></div><div class="line"><span class="built_in">UIImage</span> *img = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"dst2"</span>];</div><div class="line">[img drawAtPoint:<span class="built_in">CGPointMake</span>(<span class="number">0</span>, <span class="number">0</span>)];</div></pre></td></tr></table></figure>
<h6 id="3、图片裁剪（返回圆形边框View）"><a href="#3、图片裁剪（返回圆形边框View）" class="headerlink" title="3、图片裁剪（返回圆形边框View）"></a>3、图片裁剪（返回圆形边框View）</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">UIImage</span> *)zc_circleImage</div><div class="line">&#123;</div><div class="line"><span class="comment">//NO -&gt; 透明</span></div><div class="line"><span class="built_in">UIGraphicsBeginImageContextWithOptions</span>(<span class="keyword">self</span>.size, <span class="literal">NO</span>, <span class="number">0.0</span>);</div><div class="line"><span class="comment">//获取上下文</span></div><div class="line"><span class="built_in">CGContextRef</span> contex = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line"><span class="comment">//添加圆</span></div><div class="line"><span class="built_in">CGRect</span> rect = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="keyword">self</span>.size.width, <span class="keyword">self</span>.size.height);</div><div class="line"><span class="built_in">CGContextAddEllipseInRect</span>(contex, rect);</div><div class="line"><span class="comment">//裁剪</span></div><div class="line"><span class="built_in">CGContextClip</span>(contex);</div><div class="line"><span class="comment">//将图片画上去</span></div><div class="line">[<span class="keyword">self</span> drawInRect:rect];</div><div class="line"><span class="comment">//获取图片</span></div><div class="line"><span class="built_in">UIImage</span> *image = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</div><div class="line"><span class="comment">//关闭</span></div><div class="line"><span class="built_in">UIGraphicsEndImageContext</span>();</div><div class="line"><span class="keyword">return</span> image;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong> 因为绘图操作是 CPU密集型操作（会大量使用到 CPU），所以如果可以使用普通 UIView 来代替的就不要自己进行绘图</strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/UICollectionview/" itemprop="url">
                  UICollectionView
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T10:31:23+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UI/" itemprop="url" rel="index">
                    <span itemprop="name">UI</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>基础要点<ol>
<li>UICollectionView的dataSource、delegate</li>
<li>UICollectionView多组数据和单组数据的展示</li>
<li>UICollectionView、UICollectionViewFlowLayout的常见属性</li>
<li>UICollectionViewCell三种注册方式（Class、Nib、storyboard）</li>
<li>自定义UICollectionViewFlowLayout布局</li>
</ol>
</li>
</ul>
<h2 id="一、数据源和代理方法"><a href="#一、数据源和代理方法" class="headerlink" title="一、数据源和代理方法"></a>一、数据源和代理方法</h2><h4 id="1、UICollectionViewDataSource（数据源）"><a href="#1、UICollectionViewDataSource（数据源）" class="headerlink" title="1、UICollectionViewDataSource（数据源）"></a>1、UICollectionViewDataSource（数据源）</h4><ul>
<li><p>有多少组</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSInteger</span>)numberOfSectionsInCollectionView:(<span class="built_in">UICollectionView</span> *)collectionView</div></pre></td></tr></table></figure>
</li>
<li><p>有多少行（@required）</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSInteger</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView numberOfItemsInSection:(<span class="built_in">NSInteger</span>)section;</div></pre></td></tr></table></figure>
</li>
<li><p>cell（@required）</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">UICollectionViewCell</span> *)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView cellForItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</div></pre></td></tr></table></figure>
</li>
<li><p>返回collecctionView的头尾部视图</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">UICollectionReusableView</span> *)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView viewForSupplementaryElementOfKind:(<span class="built_in">NSString</span> *)kind atIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</div><div class="line">	</div><div class="line">	- (<span class="keyword">nullable</span> <span class="built_in">UICollectionViewLayoutAttributes</span> *)layoutAttributesForSupplementaryElementOfKind:(<span class="built_in">NSString</span> *)kind atIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</div><div class="line">当自定义loyout布局对象时，需重写方法<span class="number">2</span>设置布局属性，否则无法显示</div></pre></td></tr></table></figure>
</li>
<li><p>Move</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView canMoveItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_0);</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView moveItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)sourceIndexPath toIndexPath:(<span class="built_in">NSIndexPath</span>*)destinationIndexPath <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">9</span>_0);</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="2、UICollectionViewDelegate（代理）"><a href="#2、UICollectionViewDelegate（代理）" class="headerlink" title="2、UICollectionViewDelegate（代理）"></a>2、UICollectionViewDelegate（代理）</h4><ul>
<li>Selected  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView didSelectItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="3、UICollectionViewFlowLayout"><a href="#3、UICollectionViewFlowLayout" class="headerlink" title="3、UICollectionViewFlowLayout"></a>3、UICollectionViewFlowLayout</h4><h6 id="见案例"><a href="#见案例" class="headerlink" title="见案例"></a>见案例</h6><h2 id="二、UICollectionViewController"><a href="#二、UICollectionViewController" class="headerlink" title="二、UICollectionViewController"></a>二、UICollectionViewController</h2><h4 id="要点把握"><a href="#要点把握" class="headerlink" title="要点把握"></a>要点把握</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">self</span>.view 和 <span class="keyword">self</span>.collectionView 代表的是不同类型的, <span class="keyword">self</span>.collectionView 才是  collectionView</div><div class="line"></div><div class="line"><span class="keyword">self</span>.collectionViewLayout  只读的</div><div class="line"><span class="keyword">self</span>.collectionView.collectionViewLayout 如果使用需要进行一次强转</div></pre></td></tr></table></figure>
<ul>
<li>组头组尾的时候, 必须通过数据源方法</li>
<li><p>如果在storyboard 中拖拽 组头的话,  必须设置重用标识符, 不然数据源方法不会执行</p>
</li>
<li><p>必须通过这个方法返回 </p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">UICollectionReusableView</span> *)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView viewForSupplementaryElementOfKind:(<span class="built_in">NSString</span> *)kind atIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</div></pre></td></tr></table></figure>
</li>
<li><p>kind类型</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">UICollectionElementKindSectionHeader</span>  页眉</div><div class="line"><span class="built_in">UICollectionElementKindSectionFooter</span>  页脚</div></pre></td></tr></table></figure>
</li>
<li><p>悬浮效果</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">flowLayout.sectionHeadersPinToVisibleBounds = <span class="literal">YES</span>;</div><div class="line">flowLayout.sectionFootersPinToVisibleBounds = <span class="literal">YES</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>设置组头/尾 的size</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">flowLayout.headerReferenceSize = <span class="built_in">CGSizeMake</span>(<span class="number">10</span>, <span class="number">10</span>);</div><div class="line">flowLayout.footerReferenceSize = <span class="built_in">CGSizeMake</span>(<span class="number">10</span>, <span class="number">20</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="三、案例：自定义collectionViewFlowLayout多组数据，自定义头尾部视图"><a href="#三、案例：自定义collectionViewFlowLayout多组数据，自定义头尾部视图" class="headerlink" title="三、案例：自定义collectionViewFlowLayout多组数据，自定义头尾部视图"></a>三、案例：自定义collectionViewFlowLayout多组数据，自定义头尾部视图</h2><h4 id="FlowLayout"><a href="#FlowLayout" class="headerlink" title="FlowLayout"></a>FlowLayout</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"ZCFlowLayout.h"</span></span></div><div class="line"><span class="comment">/** 列数 */</span></div><div class="line"><span class="meta">#define KColumnCount 5</span></div><div class="line"><span class="comment">/** 当item为图片是，一张图片行列方法正好盖住几个文字item */</span></div><div class="line"><span class="meta">#define KChangeCount 2</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ZCFlowLayout</span> ()</span></div><div class="line"><span class="comment">/** 保存所有item属性的数组 */</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSMutableArray</span> *itemsArray;</div><div class="line"><span class="comment">//保存每次计算的最大Y值</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> maxY;</div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ZCFlowLayout</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)prepareLayout &#123;</div><div class="line">    [<span class="keyword">super</span> prepareLayout];</div><div class="line">    <span class="built_in">UIEdgeInsets</span> insets = <span class="built_in">UIEdgeInsetsMake</span>(<span class="number">0</span>, ZCFoodSectionInset, ZCFoodSectionInset, ZCFoodSectionInset);</div><div class="line">    <span class="keyword">self</span>.sectionInset = insets;</div><div class="line">    <span class="comment">//起始头部View有个间距</span></div><div class="line">    <span class="built_in">CGFloat</span> viewH = ZCFoodHeaderViewH;</div><div class="line">    <span class="built_in">CGFloat</span> viewW = ZC_SCREEN_WIDTH;</div><div class="line">    <span class="built_in">CGFloat</span> bottomViewH = ZCFoodBottomViewH;</div><div class="line">    <span class="built_in">CGFloat</span> viewX = <span class="number">0</span>;</div><div class="line">    <span class="built_in">CGFloat</span> viewY = <span class="number">0</span>;</div><div class="line">    <span class="built_in">CGFloat</span> startY = viewH;</div><div class="line">    <span class="comment">//行列间距</span></div><div class="line">    <span class="built_in">CGFloat</span> rowMargin = <span class="keyword">self</span>.minimumLineSpacing;</div><div class="line">    <span class="built_in">CGFloat</span> colMargin = <span class="keyword">self</span>.minimumInteritemSpacing;</div><div class="line">    <span class="comment">//计算item的宽高</span></div><div class="line">    <span class="built_in">CGFloat</span> itemW = (ZC_SCREEN_WIDTH - insets.left - insets.right - colMargin * (KColumnCount - <span class="number">1</span>)) / KColumnCount;</div><div class="line">    <span class="built_in">CGFloat</span> itemH = ZCFoodHeaderViewH;</div><div class="line">    <span class="comment">//计算图片宽高</span></div><div class="line">    <span class="built_in">CGFloat</span> imageW = KChangeCount * itemW + rowMargin * (KChangeCount - <span class="number">1</span>);</div><div class="line">    <span class="built_in">CGFloat</span> imageH = KChangeCount * itemH + colMargin * (KChangeCount - <span class="number">1</span>);</div><div class="line">    <span class="built_in">NSInteger</span> sectionCount = [<span class="keyword">self</span>.collectionView numberOfSections];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sectionCount; i++) &#123;</div><div class="line">        <span class="comment">//组头部View属性</span></div><div class="line">        <span class="built_in">NSIndexPath</span> *indexPath = [<span class="built_in">NSIndexPath</span> indexPathForItem:<span class="number">0</span> inSection:i];</div><div class="line">        <span class="built_in">UICollectionViewLayoutAttributes</span> *viewAttrs = [<span class="built_in">UICollectionViewLayoutAttributes</span> layoutAttributesForSupplementaryViewOfKind:<span class="built_in">UICollectionElementKindSectionHeader</span> withIndexPath:indexPath];</div><div class="line">        viewAttrs.frame = <span class="built_in">CGRectMake</span>(viewX, viewY, viewW, viewH);</div><div class="line">        [<span class="keyword">self</span>.itemsArray addObject:viewAttrs];</div><div class="line">        </div><div class="line">        <span class="built_in">NSInteger</span> itemCount = [<span class="keyword">self</span>.collectionView numberOfItemsInSection:i];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; itemCount; j++) &#123;</div><div class="line">            <span class="built_in">NSIndexPath</span> *indexPath = [<span class="built_in">NSIndexPath</span> indexPathForItem:j inSection:i];</div><div class="line">            <span class="built_in">UICollectionViewLayoutAttributes</span> *itemAttribute =[<span class="built_in">UICollectionViewLayoutAttributes</span> layoutAttributesForCellWithIndexPath:indexPath];</div><div class="line">            <span class="comment">//计算行列索引</span></div><div class="line">            <span class="built_in">NSInteger</span> num = (KColumnCount - KChangeCount) * KChangeCount;</div><div class="line">            <span class="built_in">NSInteger</span> row = (j - num - <span class="number">1</span>) / KColumnCount + KChangeCount;</div><div class="line">            <span class="built_in">NSInteger</span> col = (j - num - <span class="number">1</span>) % KColumnCount;</div><div class="line">            <span class="comment">//计算item的X/Y值</span></div><div class="line">            <span class="built_in">CGFloat</span> itemX = insets.left + (itemW + rowMargin) * col;</div><div class="line">            <span class="built_in">CGFloat</span> itemY = startY + insets.top + (itemH + colMargin) * row;</div><div class="line">            <span class="comment">//图片</span></div><div class="line">            <span class="keyword">if</span> (j == <span class="number">0</span>) &#123;</div><div class="line">                itemX = insets.left;</div><div class="line">                itemY = startY + insets.top;</div><div class="line">                itemAttribute.frame = <span class="built_in">CGRectMake</span>(itemX, itemY, imageW, imageH);</div><div class="line">                [<span class="keyword">self</span>.itemsArray addObject:itemAttribute];</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (j &lt;= num) &#123;</div><div class="line">                <span class="comment">//重新计算行列索引</span></div><div class="line">                row = (j - <span class="number">1</span>) / (KColumnCount - KChangeCount);</div><div class="line">                col = (j - <span class="number">1</span>) % (KColumnCount - KChangeCount);</div><div class="line">                <span class="comment">//计算item的X/Y值</span></div><div class="line">                itemX = insets.left + imageW + rowMargin + (itemW + rowMargin) * col;</div><div class="line">                itemY = startY + insets.top + (itemH + colMargin) * row;</div><div class="line">            &#125;</div><div class="line">            itemAttribute.frame = <span class="built_in">CGRectMake</span>(itemX, itemY, itemW , itemH);</div><div class="line">            [<span class="keyword">self</span>.itemsArray addObject:itemAttribute];</div><div class="line">            _maxY = <span class="built_in">CGRectGetMaxY</span>(itemAttribute.frame);</div><div class="line">        &#125;</div><div class="line">        indexPath = [<span class="built_in">NSIndexPath</span> indexPathForItem:itemCount inSection:i];</div><div class="line">        viewAttrs = [<span class="built_in">UICollectionViewLayoutAttributes</span> layoutAttributesForSupplementaryViewOfKind:<span class="built_in">UICollectionElementKindSectionFooter</span> withIndexPath:indexPath];</div><div class="line">        viewAttrs.frame = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, _maxY + insets.bottom, viewW, bottomViewH);</div><div class="line">        [<span class="keyword">self</span>.itemsArray addObject:viewAttrs];</div><div class="line">        _maxY = _maxY + insets.bottom + bottomViewH;</div><div class="line">        viewY = _maxY;</div><div class="line">        startY = _maxY + viewH + insets.top;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">self</span>.collectionView.contentSize = <span class="built_in">CGSizeMake</span>(<span class="number">0</span>, _maxY);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">CGSize</span>)collectionViewContentSize &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.collectionView.contentSize;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">NSArray</span>&lt;<span class="built_in">UICollectionViewLayoutAttributes</span> *&gt; *)layoutAttributesForElementsInRect:(<span class="built_in">CGRect</span>)rect &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.itemsArray;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">NSMutableArray</span> *)itemsArray &#123;</div><div class="line">    <span class="keyword">if</span> (!_itemsArray) &#123;</div><div class="line">        _itemsArray = [<span class="built_in">NSMutableArray</span> array];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> _itemsArray;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<h4 id="ViewController"><a href="#ViewController" class="headerlink" title="ViewController"></a>ViewController</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"ZCFoodViewController.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"ZCFlowLayout.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"ZCCategoryModel.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"ZCCollectionHeaderView.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"ZCImageCell.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"ZCWordCell.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"ZCMaterialDescriptionViewController.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"ZCFavoriteViewController.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"ZCFoodTherapyViewController.h"</span></span></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"ZCCategoryModel.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"ZCFoodModel.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ZCFoodViewController</span> ()&lt;<span class="title">UICollectionViewDelegateFlowLayout</span>&gt;</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) ZCFlowLayout *flowLayout;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSArray</span> *dataArray;</div><div class="line"><span class="keyword">@end</span></div><div class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> headerIdentifier = <span class="string">@"header"</span>;</div><div class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> *<span class="keyword">const</span> footerIdentifier = <span class="string">@"footer"</span>;</div><div class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> *imageId = <span class="string">@"imageCell"</span>;</div><div class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> *wordId = <span class="string">@"wordCell"</span>;</div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ZCFoodViewController</span></span></div><div class="line"><span class="comment">// 初始化自动设置流水布局</span></div><div class="line">- (<span class="keyword">instancetype</span>)init</div><div class="line">&#123;</div><div class="line">    ZCFlowLayout *flowLayout = [[ZCFlowLayout alloc] init];</div><div class="line">    <span class="keyword">self</span>.flowLayout = flowLayout;</div><div class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithCollectionViewLayout:flowLayout];</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;&#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</div><div class="line">    [<span class="keyword">super</span> viewDidLoad];</div><div class="line">    <span class="comment">// 设置CollectionView</span></div><div class="line">    [<span class="keyword">self</span> setupCollectionView];</div><div class="line">    <span class="comment">//添加刷新控件</span></div><div class="line">    [<span class="keyword">self</span> addRefresh];</div><div class="line">&#125;</div><div class="line"><span class="comment">// 设置CollectionView</span></div><div class="line">- (<span class="keyword">void</span>)setupCollectionView &#123;</div><div class="line">    <span class="keyword">self</span>.collectionView.backgroundColor = [<span class="built_in">UIColor</span> whiteColor];</div><div class="line">    <span class="comment">// 注册cell</span></div><div class="line">    [<span class="keyword">self</span>.collectionView registerNib:[<span class="built_in">UINib</span> nibWithNibName:<span class="built_in">NSStringFromClass</span>([ZCImageCell <span class="keyword">class</span>]) bundle:<span class="literal">nil</span>] forCellWithReuseIdentifier:imageId];</div><div class="line">    [<span class="keyword">self</span>.collectionView registerNib:[<span class="built_in">UINib</span> nibWithNibName:<span class="built_in">NSStringFromClass</span>([ZCWordCell <span class="keyword">class</span>]) bundle:<span class="literal">nil</span>] forCellWithReuseIdentifier:wordId];</div><div class="line">    <span class="comment">// 注册section头／尾</span></div><div class="line">    [<span class="keyword">self</span>.collectionView registerClass:[ZCCollectionHeaderView <span class="keyword">class</span>] forSupplementaryViewOfKind:<span class="built_in">UICollectionElementKindSectionHeader</span> withReuseIdentifier:headerIdentifier];</div><div class="line">    [<span class="keyword">self</span>.collectionView registerClass:[<span class="built_in">UICollectionReusableView</span> <span class="keyword">class</span>] forSupplementaryViewOfKind:<span class="built_in">UICollectionElementKindSectionFooter</span> withReuseIdentifier:footerIdentifier];</div><div class="line">    <span class="keyword">self</span>.collectionView.contentInset = <span class="built_in">UIEdgeInsetsMake</span>(<span class="number">64</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">0</span>);</div><div class="line">    <span class="keyword">self</span>.collectionView.scrollIndicatorInsets = <span class="built_in">UIEdgeInsetsMake</span>(<span class="number">64</span>, <span class="number">0</span>, <span class="number">49</span>, <span class="number">0</span>);</div><div class="line">    <span class="keyword">self</span>.flowLayout.minimumInteritemSpacing = <span class="number">10</span>;</div><div class="line">    <span class="keyword">self</span>.flowLayout.minimumLineSpacing = <span class="number">10</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">//添加刷新控件</span></div><div class="line">- (<span class="keyword">void</span>)addRefresh &#123;</div><div class="line">    <span class="keyword">self</span>.collectionView.mj_header = [MJRefreshNormalHeader headerWithRefreshingTarget:<span class="keyword">self</span> refreshingAction:<span class="keyword">@selector</span>(loadNewData)];</div><div class="line">    <span class="comment">//加载数据</span></div><div class="line">    [<span class="keyword">self</span>.collectionView.mj_header beginRefreshing];</div><div class="line">&#125;</div><div class="line"><span class="comment">// 获取数据</span></div><div class="line">- (<span class="keyword">void</span>)loadNewData &#123;</div><div class="line">    <span class="comment">// 设置请求参数</span></div><div class="line">    <span class="built_in">NSMutableDictionary</span> *parameters = [<span class="built_in">NSMutableDictionary</span> dictionary];</div><div class="line">    parameters[<span class="string">@"methodName"</span>] = <span class="keyword">self</span>.methodName;</div><div class="line">    parameters[<span class="string">@"version"</span>] = @<span class="number">4.4</span>;</div><div class="line">    [[ZCNetWorking sharedInstance] postWithUrlString:<span class="string">@"http://api.izhangchu.com/?appVersion=4.4&amp;sysVersion=9.3.2&amp;devModel=iPhone"</span> withParameter:parameters withComplection:^(<span class="built_in">NSDictionary</span> *responseObject) &#123;</div><div class="line">        <span class="keyword">self</span>.dataArray = [ZCCategoryModel mj_objectArrayWithKeyValuesArray:responseObject[<span class="string">@"data"</span>][<span class="string">@"data"</span>]];</div><div class="line">        [<span class="keyword">self</span>.collectionView reloadData];</div><div class="line">        [<span class="keyword">self</span>.collectionView.mj_header endRefreshing];</div><div class="line">    &#125; withFailure:^(<span class="built_in">NSError</span> *error) &#123;</div><div class="line">        [<span class="keyword">self</span>.collectionView.mj_header endRefreshing];</div><div class="line">        [SVProgressHUD showErrorWithStatus:<span class="string">@"加载失败"</span>];</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"><span class="meta">#pragma mark - UICollectionViewDataSource</span></div><div class="line">- (<span class="built_in">NSInteger</span>)numberOfSectionsInCollectionView:(<span class="built_in">UICollectionView</span> *)collectionView &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.dataArray.count;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">NSInteger</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView numberOfItemsInSection:(<span class="built_in">NSInteger</span>)section &#123;</div><div class="line">    <span class="built_in">NSInteger</span> count = [[<span class="keyword">self</span>.dataArray[section] foodArray] count];</div><div class="line">    <span class="keyword">return</span>  count ? count + <span class="number">1</span> : <span class="number">0</span> ;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">UICollectionViewCell</span> *)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView cellForItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</div><div class="line">    <span class="keyword">if</span> (indexPath.item) &#123;</div><div class="line">        ZCWordCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:wordId forIndexPath:indexPath];</div><div class="line">        ZCFoodModel *model = [<span class="keyword">self</span>.dataArray[indexPath.section] foodArray][indexPath.item - <span class="number">1</span>];</div><div class="line">        cell.textLabel.text = model.text;</div><div class="line">        <span class="keyword">return</span> cell;</div><div class="line">    &#125;</div><div class="line">    ZCImageCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:imageId forIndexPath:indexPath];</div><div class="line">    ZCCategoryModel *model = <span class="keyword">self</span>.dataArray[indexPath.section];</div><div class="line">    [cell.iconImageView sd_setImageWithURL:[<span class="built_in">NSURL</span> URLWithString:model.image]];</div><div class="line">    <span class="keyword">return</span> cell;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView didSelectItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</div><div class="line">    <span class="keyword">if</span> (indexPath.item) &#123;</div><div class="line">        ZCFoodModel *model = [<span class="keyword">self</span>.dataArray[indexPath.section] foodArray][indexPath.item - <span class="number">1</span>];</div><div class="line">        <span class="keyword">if</span> ([<span class="keyword">self</span>.methodName  isEqual: <span class="string">@"MaterialSubtype"</span>]) &#123;</div><div class="line">            <span class="comment">//食疗</span></div><div class="line">            ZCMaterialDescriptionViewController *descVc = [[ZCMaterialDescriptionViewController alloc] init];</div><div class="line">            descVc.title = model.text;</div><div class="line">            descVc.ID = model.ID;</div><div class="line">            [<span class="keyword">self</span>.navigationController pushViewController:descVc animated:<span class="literal">YES</span>];</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> ([<span class="keyword">self</span>.methodName  isEqual: <span class="string">@"CategoryIndex"</span>]) &#123;</div><div class="line">            <span class="comment">//分类</span></div><div class="line">            <span class="keyword">if</span> (model.type == <span class="number">1</span>) &#123;</div><div class="line">                ZCFavoriteViewController *favoriteVc = [[ZCFavoriteViewController alloc] init];</div><div class="line">                favoriteVc.title = model.text;</div><div class="line">                <span class="built_in">NSMutableDictionary</span> *parameters = [<span class="built_in">NSMutableDictionary</span> dictionary];</div><div class="line">                parameters[<span class="string">@"size"</span>] = @<span class="number">20</span>;</div><div class="line">                parameters[<span class="string">@"page"</span>] = @<span class="number">1</span>;</div><div class="line">                parameters[<span class="string">@"methodName"</span>] = <span class="string">@"CategorySearch"</span>;</div><div class="line">                parameters[<span class="string">@"cat_id"</span>] = model.ID;</div><div class="line">                parameters[<span class="string">@"type"</span>] = @<span class="number">1</span>;</div><div class="line">                parameters[<span class="string">@"version"</span>] = @<span class="number">4.4</span>;</div><div class="line">                favoriteVc.parameters = parameters;</div><div class="line">                [<span class="keyword">self</span>.navigationController pushViewController:favoriteVc animated:<span class="literal">YES</span>];</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (model.type == <span class="number">2</span>) &#123;</div><div class="line">                <span class="comment">//食疗</span></div><div class="line">                ZCFoodTherapyViewController *thrapyVc = [[ZCFoodTherapyViewController alloc] init];</div><div class="line">                thrapyVc.department_id = model.ID;</div><div class="line">                [<span class="keyword">self</span>.navigationController pushViewController:thrapyVc animated:<span class="literal">YES</span>];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//设置头部/尾部视图</span></div><div class="line">- (<span class="built_in">UICollectionReusableView</span> *)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView viewForSupplementaryElementOfKind:(<span class="built_in">NSString</span> *)kind atIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</div><div class="line">    <span class="keyword">if</span> ([kind isEqualToString:<span class="built_in">UICollectionElementKindSectionHeader</span>]) &#123;</div><div class="line">        ZCCollectionHeaderView *headerView = [collectionView dequeueReusableSupplementaryViewOfKind:kind withReuseIdentifier:headerIdentifier forIndexPath:indexPath];</div><div class="line">        ZCCategoryModel *model = <span class="keyword">self</span>.dataArray[indexPath.section];</div><div class="line">        headerView.titleLabel.text = model.text;</div><div class="line">        <span class="keyword">return</span> headerView;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="built_in">UICollectionReusableView</span> *footerView = [collectionView dequeueReusableSupplementaryViewOfKind:kind withReuseIdentifier:footerIdentifier forIndexPath:indexPath];</div><div class="line">        footerView.backgroundColor = ZC_GLOBAL_COLOR;</div><div class="line">        <span class="keyword">return</span> footerView;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">#pragma mark - UICollectionViewDelegateFlowLayout</span></div><div class="line"><span class="comment">//sectionHeaderSize</span></div><div class="line">- (<span class="built_in">CGSize</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView layout:(<span class="built_in">UICollectionViewLayout</span> *)collectionViewLayout referenceSizeForHeaderInSection:(<span class="built_in">NSInteger</span>)section &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">CGSizeMake</span>(<span class="number">0</span>, ZCFoodHeaderViewH);</div><div class="line">&#125;</div><div class="line"><span class="comment">//sectionFooterSize</span></div><div class="line">- (<span class="built_in">CGSize</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView layout:(<span class="built_in">UICollectionViewLayout</span> *)collectionViewLayout referenceSizeForFooterInSection:(<span class="built_in">NSInteger</span>)section &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">CGSizeMake</span>(<span class="number">0</span>, ZCFoodBottomViewH);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/NSRange使用/" itemprop="url">
                  NSRange使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T10:31:23+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/OC/" itemprop="url" rel="index">
                    <span itemprop="name">OC</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="四、NSRange使用"><a href="#四、NSRange使用" class="headerlink" title="四、NSRange使用"></a>四、NSRange使用</h2><ul>
<li><strong>1、NSRange的使用</strong></li>
<li><p>NSRange是Foundation框架中比较常用的结构体, 它的定义如下:</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> _NSRange &#123;</div><div class="line">    <span class="built_in">NSUInteger</span> location;</div><div class="line">    <span class="built_in">NSUInteger</span> length;</div><div class="line">&#125; <span class="built_in">NSRange</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>NSUInteger的定义</p>
 <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="built_in">NSUInteger</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>NSRange用来表示事物的一个范围,通常是字符串里的字符范围或者数组里的元素范围。</p>
<ul>
<li>NSRange有2个成员</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSUInteger</span> location : 表示该范围的起始位置</div><div class="line"><span class="built_in">NSUInteger</span> length : 表示该范围内的长度</div><div class="line"></div><div class="line"> 比如@“I love iOS”中的@“iOS”可以用location为<span class="number">7</span>，length为<span class="number">3</span>的范围来表示.</div></pre></td></tr></table></figure>
</li>
<li><p><strong>2、NSRange创建的几种方式</strong></p>
</li>
<li><p>有3种方式创建一个NSRange变量</p>
<ul>
<li><p>方式1</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSRange</span> range;</div><div class="line">range.location = <span class="number">7</span>;</div><div class="line">range.length = <span class="number">3</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>方式2</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSRange</span> range = &#123;<span class="number">7</span>, <span class="number">3</span>&#125;;</div><div class="line"><span class="comment">// 或者</span></div><div class="line"><span class="built_in">NSRange</span> range = &#123;.location = <span class="number">7</span>,.length = <span class="number">3</span>&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p>方式3 : 使用NSMakeRange函数</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSRange</span> range = <span class="built_in">NSMakeRange</span>(<span class="number">7</span>, <span class="number">3</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/07/数据解析/" itemprop="url">
                  数据解析
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-07T10:31:23+08:00" content="2016-07-07">
              2016-07-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/网络与多线程/" itemprop="url" rel="index">
                    <span itemprop="name">网络与多线程</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、JSON数据"><a href="#一、JSON数据" class="headerlink" title="一、JSON数据"></a>一、JSON数据</h2><h4 id="1、什么是JSON数据"><a href="#1、什么是JSON数据" class="headerlink" title="1、什么是JSON数据"></a>1、什么是JSON数据</h4><h6 id="1、JSON-是一种轻量级的传输数据格式-用于数据交互"><a href="#1、JSON-是一种轻量级的传输数据格式-用于数据交互" class="headerlink" title="1、JSON:是一种轻量级的传输数据格式,用于数据交互"></a>1、JSON:是一种轻量级的传输数据格式,用于数据交互</h6><ul>
<li>JSON是javascript语言的一个子集.javascript是个脚本语言(不需要编译),用来给HTML增加动态功能.</li>
<li>javascript和java没有半毛钱的关系!</li>
<li>服务器返回给客户端的数据,一般都是JSON格式或者XML格式(文件下载除外).</li>
<li><p>语法规则: </p>
<ul>
<li><p><1> 数据以键值的方式保存;</1></p>
<p>  键(key)必须用双引号(“key”),与键值之间* 以’:’分隔; {“name”:”小明”}</p>
</li>
<li><p><2> 数据和数据之间以逗号(,)分隔. {“name”:”小明”,”age”:13}</2></p>
</li>
<li><p><3> {}表示对象. “person”:{“name”:”小明”,”age”:13}</3></p>
</li>
<li><p><4> []表示数组. “persons”:[</4></p>
<pre><code>{&quot;name&quot;:&quot;小明&quot;,&quot;age&quot;:13},
{&quot;name&quot;:&quot;小红&quot;,&quot;age&quot;:14},
{&quot;name&quot;:&quot;小花&quot;,&quot;age&quot;:15}
</code></pre><p>  ]</p>
</li>
</ul>
</li>
</ul>
<h6 id="2、JSON与OC转换对照"><a href="#2、JSON与OC转换对照" class="headerlink" title="2、JSON与OC转换对照:"></a>2、JSON与OC转换对照:</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">大括号 &#123;&#125; == <span class="built_in">NSDictionary</span>;</div><div class="line">中括号 [] == <span class="built_in">NSArray</span>;</div><div class="line">双引号<span class="string">" "</span> == <span class="built_in">NSString</span>;</div><div class="line">数字<span class="number">13</span>,<span class="number">13.5</span> == <span class="built_in">NSNumber</span>;</div></pre></td></tr></table></figure>
<h6 id="3、数据传输过程"><a href="#3、数据传输过程" class="headerlink" title="3、数据传输过程:"></a>3、数据传输过程:</h6><ul>
<li>客户端发送请求给服务器,服务器接收到客户端的请求之后,返回给客户端JSON数据.</li>
<li>客户端需要把服务器返回的JSON数据转换为OC的数据格式(数组/字典等).</li>
</ul>
<h4 id="2、JSON数据解析"><a href="#2、JSON数据解析" class="headerlink" title="2、JSON数据解析"></a>2、JSON数据解析</h4><h6 id="1、JSON数据解析方法"><a href="#1、JSON数据解析方法" class="headerlink" title="1、JSON数据解析方法:"></a>1、JSON数据解析方法:</h6><ul>
<li>在iOS中,常见的JSON数据解析方案有4种:   </li>
<li>第三方框架:JSONKit, SBJson, TouchJson.性能从左到右,依次变差.(iOS 5(2011年)以前)</li>
<li>苹果原生(自带):NSJSONSerialization (性能是最好的.iOS5以后推出).</li>
</ul>
<h6 id="2、解析JSON数据"><a href="#2、解析JSON数据" class="headerlink" title="2、解析JSON数据"></a>2、解析JSON数据</h6><p><strong>反序列化(解析):</strong></p>
<ul>
<li><p>将从服务器接收到的JSON数据(二进制数据)转换成OC数据类型(NSArray,NSDictionary等.)的过程.</p>
</li>
<li><p>目的: JSON数据 –&gt; OC对象; 得到数据字典或者数据数组</p>
</li>
<li><p>好处: 简化程序的开发,方便后续的字典转模型.</p>
</li>
<li><p>方法:</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">+(<span class="keyword">id</span>)JSONObjectWithData:(<span class="built_in">NSData</span> *)data options:(<span class="built_in">NSJSONReadingOptions</span>)opt error:(<span class="built_in">NSError</span> **)error;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>序列化:</strong></p>
<ul>
<li>将数组或者字典发送给服务器之前,转换成二进制数据.</li>
<li>目的:OC对象 –&gt; JSON数据;得到二进制JSON数据 NSData.</li>
<li>好处:方便网络传输,提高传输速度.</li>
<li>方法:  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">+(<span class="built_in">NSData</span> *)dataWithJSONObject:(<span class="keyword">id</span>)obj options:(<span class="built_in">NSJSONWritingOptions</span>)opt error:(<span class="built_in">NSError</span> **)error;</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>需要注意的是,在做序列化之前,一定要检测一下对象是否能够被序列化.（使用 isValidJSONObject 检测一下要序列化的对象，是否能够正确被序列化）</strong></p>
<h2 id="二、XML数据"><a href="#二、XML数据" class="headerlink" title="二、XML数据"></a>二、XML数据</h2><h4 id="1、什么是XML"><a href="#1、什么是XML" class="headerlink" title="1、什么是XML"></a>1、什么是XML</h4><h6 id="1、XML-eXtensible-Markup-Language-’可扩展标记语言’"><a href="#1、XML-eXtensible-Markup-Language-’可扩展标记语言’" class="headerlink" title="1、XML(eXtensible Markup Language)’可扩展标记语言’"></a>1、XML(eXtensible Markup Language)’可扩展标记语言’</h6><ul>
<li>XML跟JSON一样,也是用来数据交互.</li>
<li>HTML是超文本标记语言.用来表示网页页面.<h6 id="2、XML语法简介"><a href="#2、XML语法简介" class="headerlink" title="2、XML语法简介"></a>2、XML语法简介</h6></li>
<li><p>一个完整的XML文件叫XML文档(XML Document).一个XML文档一般由以下几部分组成:</p>
<ul>
<li><p><1> 文档声明:</1></p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> standalone=<span class="string">"yes"</span>?&gt;</div></pre></td></tr></table></figure>
</li>
<li><p><2> 元素(Element)</2></p>
  <figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">1&gt; 一个元素包括开始标签和结束标签.</div><div class="line">	&lt;name&gt;小红&lt;/name&gt;</div><div class="line"></div><div class="line">	一个元素可以没有元素内容,没有元素内容可以简写.</div><div class="line">	&lt;/person&gt;</div><div class="line"></div><div class="line">	XML中所有的空格和换行,都会当做具体的内容处理.</div><div class="line"></div><div class="line">2&gt; 一个元素可以嵌套若干个子元素(不能出现交叉嵌套).</div><div class="line">	&lt;person&gt;</div><div class="line">	&lt;name&gt;小花&lt;/name&gt;</div><div class="line">	&lt;age&gt;16&lt;/age&gt;</div><div class="line">	&lt;/person&gt;</div><div class="line"></div><div class="line">3&gt; 规范的XML文档最多只能有一个根元素,其他元素都是根元素的子元素.</div></pre></td></tr></table></figure>
</li>
<li><p><3> 属性(Attribute)</3></p>
  <figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">1&gt; 一个元素可以拥有多个属性.</div><div class="line">&lt;person name = "小明" age = "18"/&gt;</div><div class="line">2&gt; 属性值必须用双引号""或者单引号''括住.</div><div class="line">3&gt; 属性信息可以用元素内容来表示.</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h4 id="2、XML两种解析方式"><a href="#2、XML两种解析方式" class="headerlink" title="2、XML两种解析方式"></a>2、XML两种解析方式</h4><ul>
<li>XML 解析有两种不同的思路:  SAX 解析  DOM 解析.</li>
<li>SAX 解析: 从 XML 文档的根元素开始,一行一行的逐行解析XML元素中的内容!  在移动端使用比较多!可以较小内存开销!</li>
<li>DOM 解析: 将整个 XML 文档加载到内存中,然后在解析! 占用内存比较多,在 PC(电脑) 中使用比较多<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    XML解析:</div><div class="line">    </div><div class="line">        所谓XML解析,指的就是将XML中元素的内容取出来或者将元素中的属性值提取出来.</div><div class="line">    </div><div class="line">    XML解析方式: <span class="number">1.</span>SAX <span class="number">2.</span>DOM</div><div class="line">    </div><div class="line">    <span class="number">1.</span>SAX解析:</div><div class="line">    </div><div class="line">        从根元素开始,一个元素一个元素的按顺序往下解析.</div><div class="line">    </div><div class="line">        比较适合大文件的解析.</div><div class="line">    </div><div class="line">    * 解析方法:</div><div class="line">    </div><div class="line">        苹果原生: <span class="built_in">NSXMLParser</span> ,使用简单.设置代理就可以了.</div><div class="line">    </div><div class="line">        <span class="built_in">NSXMLParser</span> 采用SAX方式逐行往下解析,当扫描到下面的情况都会通知代理.</div><div class="line">    </div><div class="line">            &lt;<span class="number">1</span>&gt; 扫描到文档(Doucument)的开始与结束的时候,会通知代理.</div><div class="line">    </div><div class="line">            &lt;<span class="number">2</span>&gt; 扫描到元素(Element)的开始与结束的时候,会通知代理.</div><div class="line">    </div><div class="line">            &lt;<span class="number">3</span>&gt; 扫描到元素中的内容的时候,会通知代理.</div><div class="line">    </div><div class="line">    * 使用步骤:</div><div class="line">    &#123;</div><div class="line">        <span class="comment">// 1.传入XML,创建解析器</span></div><div class="line">        <span class="built_in">NSXMLParser</span> *parser = [[<span class="built_in">NSXMLParser</span> alloc] initWithData:data];</div><div class="line">        </div><div class="line">        <span class="comment">// 2.设置代理,监听解析过程</span></div><div class="line">        parser.delegate = <span class="keyword">self</span>;</div><div class="line">        </div><div class="line">        <span class="comment">// 3.开始解析</span></div><div class="line">        [parser parse];</div><div class="line">        </div><div class="line">        <span class="comment">// 4.解析完毕之后刷新表格数据</span></div><div class="line">        [<span class="keyword">self</span>.tableView reloadData];</div><div class="line">        </div><div class="line">        <span class="comment">// 4.实现代理方法</span></div><div class="line">        &#123;</div><div class="line">            <span class="comment">// 1.当扫描到文档的开始时调用（开始解析）</span></div><div class="line">            - (<span class="keyword">void</span>)parserDidStartDocument:(<span class="built_in">NSXMLParser</span> *)parser;</div><div class="line">            </div><div class="line">            <span class="comment">// 2.当扫描到元素的开始时调用（attributeDict存放着元素的属性）</span></div><div class="line">            - (<span class="keyword">void</span>)parser:(<span class="built_in">NSXMLParser</span> *)parser didStartElement:(<span class="built_in">NSString</span> *)elementName namespaceURI:(<span class="built_in">NSString</span> *)namespaceURI qualifiedName:(<span class="built_in">NSString</span> *)qName attributes:(<span class="built_in">NSDictionary</span> *)attributeDict;</div><div class="line">            </div><div class="line">            <span class="comment">// 3.发现元素中的内容的时候开始调用</span></div><div class="line">            - (<span class="keyword">void</span>)parser:(<span class="built_in">NSXMLParser</span> *)parser foundCharacters:(<span class="built_in">NSString</span> *)string;</div><div class="line">            </div><div class="line">            <span class="comment">// 4.当扫描到元素结束时调用</span></div><div class="line">            - (<span class="keyword">void</span>)parser:(<span class="built_in">NSXMLParser</span> *)parser didEndElement:(<span class="built_in">NSString</span> *)elementName namespaceURI:(<span class="built_in">NSString</span> *)namespaceURI qualifiedName:(<span class="built_in">NSString</span> *)qName;</div><div class="line">            </div><div class="line">            <span class="comment">// 5.当扫描到文档的结束时调用（解析完毕）</span></div><div class="line">            - (<span class="keyword">void</span>)parserDidEndDocument:(<span class="built_in">NSXMLParser</span> *)parser;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="number">2.</span>DOM解析:</div><div class="line">    </div><div class="line">        一次性将整个XML文档加载进内存,内存消耗比较大.</div><div class="line">    </div><div class="line">        比较适合小文件.更加适用于Mac.</div><div class="line">    </div><div class="line">    * 解析方法:</div><div class="line">    </div><div class="line">        第三方框架:</div><div class="line">    </div><div class="line">        * libxml2: 纯C语言,默认包含在iOS SDK中,同时支持SAX和DOM方式解析.</div><div class="line">        </div><div class="line">        * GDateXML: DOM方式解析,由Google开发,基于libxml2.</div><div class="line">    </div><div class="line">    * GDataXML使用步骤:</div><div class="line">    &#123;</div><div class="line">        &lt;<span class="number">1</span>&gt; 导入第三方框架 GDateXML;</div><div class="line">        </div><div class="line">        &lt;<span class="number">2</span>&gt; 注意修改三个地方:</div><div class="line">        </div><div class="line">            <span class="number">1</span>&gt; Header Search Paths : /usr/include/libxml2</div><div class="line">        </div><div class="line">            <span class="number">2</span>&gt; Other Linker Flags : -lxml2</div><div class="line">        </div><div class="line">            <span class="number">3</span>&gt; 添加非ARC :-fno-objc-arc</div><div class="line">        </div><div class="line">        &lt;<span class="number">3</span>&gt; 使用方法:</div><div class="line">        &#123;</div><div class="line">            <span class="comment">// 1.加载整个XML文档</span></div><div class="line">            GDataXMLDocument *dom = [[GDataXMLDocument alloc] initWithData:data options:<span class="number">0</span> error:<span class="literal">NULL</span>];</div><div class="line">            </div><div class="line">            <span class="comment">// 2.获得文档的根元素</span></div><div class="line">            GDataXMLElement *element = dom.rootElement;</div><div class="line">            </div><div class="line">            <span class="comment">// 3.得到根元素中包含的元素(vedio元素)</span></div><div class="line">            [element.children enumerateObjectsUsingBlock:^(<span class="keyword">id</span> obj, <span class="built_in">NSUInteger</span> idx, <span class="built_in">BOOL</span> *stop) &#123;</div><div class="line">                </div><div class="line">                GDataXMLElement *vedio = obj;</div><div class="line">                </div><div class="line">                ITVedio *ITvedio = [[ITVedio alloc] init];</div><div class="line">                <span class="comment">// 4.得到vedio元素中包含的元素内容</span></div><div class="line">                [vedio.children enumerateObjectsUsingBlock:^(<span class="keyword">id</span> obj, <span class="built_in">NSUInteger</span> idx, <span class="built_in">BOOL</span> *stop) &#123;</div><div class="line">                    </div><div class="line">                    GDataXMLElement *ele = obj;</div><div class="line">                    </div><div class="line">                    <span class="comment">// 5.将元素内容取出赋值.</span></div><div class="line">                    [ITvedio setValue:ele.stringValue forKeyPath:ele.name];</div><div class="line">                    </div><div class="line">                &#125;];</div><div class="line">                </div><div class="line">                <span class="comment">// 将数据模型放在数据源中.</span></div><div class="line">                [<span class="keyword">self</span>.vedios addObject:ITvedio];</div><div class="line">                </div><div class="line">            &#125;];</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="补充知识点"><a href="#补充知识点" class="headerlink" title="补充知识点"></a>补充知识点</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    注意:播放视频</div><div class="line">    </div><div class="line">    <span class="number">1.</span> 导入: MediaPlayer/MediaPlayer.h</div><div class="line">    <span class="meta">#import <span class="meta-string">&lt;MediaPlayer/MediaPlayer.h&gt;</span></span></div><div class="line">    </div><div class="line">    <span class="number">2.</span> 创建视频播放控制器</div><div class="line">    <span class="built_in">MPMoviePlayerViewController</span> *mv = [[<span class="built_in">MPMoviePlayerViewController</span> alloc] initWithContentURL:url];</div><div class="line">    </div><div class="line">    <span class="number">3.</span> 跳转到控制器播放视频</div><div class="line">    [<span class="keyword">self</span> presentMoviePlayerViewControllerAnimated:mv];</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="built_in">NSNumber</span> 替代 <span class="keyword">int</span>,防止 null 错误.</div><div class="line">    </div><div class="line">    <span class="built_in">NSArray</span> + Log 分类,打印汉字,方便调试.</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/07/06/UITableView/" itemprop="url">
                  UITableView
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-07-06T10:31:23+08:00" content="2016-07-06">
              2016-07-06
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/UI/" itemprop="url" rel="index">
                    <span itemprop="name">UI</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="一、数据源和代理方法"><a href="#一、数据源和代理方法" class="headerlink" title="一、数据源和代理方法"></a>一、数据源和代理方法</h2><p><strong>UITableView有两种风格：UITableViewStylePlain和UITableViewStyleGrouped</strong></p>
<h4 id="1、UITableViewDataSource-数据源"><a href="#1、UITableViewDataSource-数据源" class="headerlink" title="1、UITableViewDataSource(数据源)"></a>1、UITableViewDataSource(数据源)</h4><ul>
<li><p>1、有多少组</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSInteger</span>)numberOfSectionsInTableView:(<span class="built_in">UITableView</span> *)tableView;</div></pre></td></tr></table></figure>
</li>
<li><p>2、有多少行（required）</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="built_in">NSInteger</span>)section;</div></pre></td></tr></table></figure>
</li>
<li><p>3、cell（required）</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</div></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>4、SectionHeaderView/SectionFooterView Title</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">nullable</span> <span class="built_in">NSString</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView titleForHeaderInSection:(<span class="built_in">NSInteger</span>)section;</div><div class="line">	</div><div class="line">- (<span class="keyword">nullable</span> <span class="built_in">NSString</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView titleForFooterInSection:(<span class="built_in">NSInteger</span>)section;</div></pre></td></tr></table></figure>
</li>
<li><p>5、Editing（对应indexPath的cell是否可编辑）</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[TableView setEditing:<span class="literal">YES</span> animated:<span class="literal">YES</span>];</div><div class="line"></div><div class="line">- (<span class="built_in">BOOL</span>)tableView:(<span class="built_in">UITableView</span> *)tableView canEditRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView commitEditingStyle:(<span class="built_in">UITableViewCellEditingStyle</span>)editingStyle forRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</div></pre></td></tr></table></figure>
</li>
<li><p>6、Moving/reordering</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)tableView:(<span class="built_in">UITableView</span> *)tableView canMoveRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView moveRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)sourceIndexPath toIndexPath:(<span class="built_in">NSIndexPath</span> *)destinationIndexPath;</div><div class="line">By <span class="keyword">default</span>, the reorder control will be shown only <span class="keyword">if</span> the datasource implements -tableView:moveRowAtIndexPath:toIndexPath:</div></pre></td></tr></table></figure>
</li>
<li><p>7、Index</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">返回tableView的SectionTitle的数组</div><div class="line">- (<span class="keyword">nullable</span> <span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)sectionIndexTitlesForTableView:(<span class="built_in">UITableView</span> *)tableView </div><div class="line"><span class="keyword">return</span> list of section titles to display <span class="keyword">in</span> section index view (e.g. <span class="string">"ABCD...Z#"</span>)</div><div class="line"></div><div class="line">返回具体title在tableView的哪组</div><div class="line">- (<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView sectionForSectionIndexTitle:(<span class="built_in">NSString</span> *)title atIndex:(<span class="built_in">NSInteger</span>)inde</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="2、UITableViewDelegate（代理）"><a href="#2、UITableViewDelegate（代理）" class="headerlink" title="2、UITableViewDelegate（代理）"></a>2、UITableViewDelegate（代理）</h4><ul>
<li><p>1、height</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</div><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForHeaderInSection:(<span class="built_in">NSInteger</span>)section;</div><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForFooterInSection:(<span class="built_in">NSInteger</span>)section;</div><div class="line"></div><div class="line">预估高度</div><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView estimatedHeightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">7</span>_0);</div><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView estimatedHeightForHeaderInSection:(<span class="built_in">NSInteger</span>)section <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">7</span>_0);</div><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView estimatedHeightForFooterInSection:(<span class="built_in">NSInteger</span>)section <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">7</span>_0);</div></pre></td></tr></table></figure>
</li>
<li><p>2、SectionHeaderView/SectionFooterView</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">nullable</span> <span class="built_in">UIView</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView viewForHeaderInSection:(<span class="built_in">NSInteger</span>)section;</div><div class="line"></div><div class="line">- (<span class="keyword">nullable</span> <span class="built_in">UIView</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView viewForFooterInSection:(<span class="built_in">NSInteger</span>)section;</div><div class="line"></div><div class="line"><span class="built_in">UITableViewMethod</span>（不是代理方法，当需要重用时使用以下方法设置）</div><div class="line">- (<span class="keyword">nullable</span> <span class="built_in">UITableViewHeaderFooterView</span> *)headerViewForSection:(<span class="built_in">NSInteger</span>)section <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">6</span>_0);</div><div class="line"></div><div class="line">- (<span class="keyword">nullable</span> <span class="built_in">UITableViewHeaderFooterView</span> *)footerViewForSection:(<span class="built_in">NSInteger</span>)section <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">6</span>_0);</div></pre></td></tr></table></figure>
</li>
<li><p>3、selected</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">nullable</span> <span class="built_in">NSIndexPath</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView willSelectRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</div><div class="line"></div><div class="line">- (<span class="keyword">nullable</span> <span class="built_in">NSIndexPath</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView willDeselectRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_0);</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView didSelectRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView didDeselectRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_0);</div></pre></td></tr></table></figure>
</li>
<li><p>4、用户点击cell 右边的 箭头</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView accessoryButtonTappedForRowWithIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="3、UITableViewCell"><a href="#3、UITableViewCell" class="headerlink" title="3、UITableViewCell"></a>3、UITableViewCell</h4><ul>
<li><p>1、UITableViewCellStyle</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, <span class="built_in">UITableViewCellStyle</span>) &#123;</div><div class="line">   <span class="built_in">UITableViewCellStyleDefault</span>,    <span class="comment">// 左侧显示textLabel（不显示detailTextLabel），imageView可选（显示在最左边）</span></div><div class="line">   </div><div class="line">   <span class="built_in">UITableViewCellStyleValue1</span>,     <span class="comment">// 左侧显示textLabel、右侧显示detailTextLabel（默认蓝色），imageView可选（显示在最左边）</span></div><div class="line">   </div><div class="line">   <span class="built_in">UITableViewCellStyleValue2</span>,     <span class="comment">// 左侧依次显示textLabel(默认蓝色)和detailTextLabel，imageView可选（显示在最左边）</span></div><div class="line">   </div><div class="line">   <span class="built_in">UITableViewCellStyleSubtitle</span>    <span class="comment">// 左上方显示textLabel，左下方显示detailTextLabel（默认灰色）,imageView可选（显示在最左边）</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p>2、UITableViewCell的accesoryTyp</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, <span class="built_in">UITableViewCellAccessoryType</span>) &#123;</div><div class="line">   <span class="built_in">UITableViewCellAccessoryNone</span>,                   <span class="comment">// 不显示任何图标</span></div><div class="line">   <span class="built_in">UITableViewCellAccessoryDisclosureIndicator</span>,    <span class="comment">// 跳转指示图标</span></div><div class="line">   <span class="built_in">UITableViewCellAccessoryDetailDisclosureButton</span>, <span class="comment">// 内容详情图标和跳转指示图标</span></div><div class="line">   <span class="built_in">UITableViewCellAccessoryCheckmark</span>,              <span class="comment">// 勾选图标</span></div><div class="line">   <span class="built_in">UITableViewCellAccessoryDetailButton</span>    <span class="comment">// 内容详情图标</span></div><div class="line">&#125;;</div><div class="line">`</div></pre></td></tr></table></figure>
</li>
<li><p>3、如果不希望响应select，那么就可以用下面的代码设置属性</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TableView.allowsSelection = <span class="literal">NO</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>4/如何让cell 能够响应 select，但是选中后的颜色又不发生改变呢，那么就设置</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cell.selectionStyle = <span class="built_in">UITableViewCellSelectionStyleNone</span>;</div></pre></td></tr></table></figure>
</li>
<li><p>5、如何获得 某一行的CELL对象</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">UITableViewCell</span> *)cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="4、UITableView的刷新方法"><a href="#4、UITableView的刷新方法" class="headerlink" title="4、UITableView的刷新方法"></a>4、UITableView的刷新方法</h4><ul>
<li><p>1、刷新整个表格</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)reloadData;</div></pre></td></tr></table></figure>
</li>
<li><p>2、刷新指定的分组和行</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)reloadRowsAtIndexPaths:(<span class="built_in">NSArray</span> *)indexPaths withRowAnimation:(<span class="built_in">UITableViewRowAnimation</span>)animation <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_0);</div></pre></td></tr></table></figure>
</li>
<li><p>3、刷新指定的分组</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)reloadSections:(<span class="built_in">NSIndexSet</span> *)sections withRowAnimation:(<span class="built_in">UITableViewRowAnimation</span>)animation <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_0);</div></pre></td></tr></table></figure>
</li>
<li><p>4、删除时刷新指定的行数据</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)deleteRowsAtIndexPaths:(<span class="built_in">NSArray</span> *)indexPaths withRowAnimation:(<span class="built_in">UITableViewRowAnimation</span>)animation;</div></pre></td></tr></table></figure>
</li>
<li><p>5、添加时刷新指定的行数据。</p>
  <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)insertRowsAtIndexPaths:(<span class="built_in">NSArray</span> *)indexPaths withRowAnimation:(<span class="built_in">UITableViewRowAnimation</span>)animation;</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="5、TableView的SectionHeader-SectionFooterView高度设置"><a href="#5、TableView的SectionHeader-SectionFooterView高度设置" class="headerlink" title="5、TableView的SectionHeader/SectionFooterView高度设置"></a>5、TableView的SectionHeader/SectionFooterView高度设置</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//当需要设置TableView的SectionHeaderView和FooterView的高度为0时</span></div><div class="line">	</div><div class="line"><span class="comment">//方式一：通过代理方法设置（注：返回值为0表示使用属性sectionHeaderHeight的默认值）</span></div><div class="line"><span class="comment">//优先使用代理方法设置高度，若未重写或返回值为0则通过属性设置</span></div><div class="line"></div><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForHeaderInSection:(<span class="built_in">NSInteger</span>)section &#123;</div><div class="line">    <span class="keyword">return</span> section == <span class="built_in">CGFLOAT_MIN</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForFooterInSection:(<span class="built_in">NSInteger</span>)section &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">CGFLOAT_MIN</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//方式二：通过属性赋值(可以直接设置为0，但当各组头尾的高度不一致时，需使用代理方法)</span></div><div class="line"></div><div class="line"><span class="keyword">self</span>.tableView.sectionHeaderHeight = <span class="built_in">CGFLOAT_MIN</span>;</div><div class="line"></div><div class="line"><span class="keyword">self</span>.tableView.sectionFooterHeight = <span class="built_in">CGFLOAT_MIN</span>;</div></pre></td></tr></table></figure>
<h4 id="6、隐藏TableView的tableHeaderView-tableFooterView设置"><a href="#6、隐藏TableView的tableHeaderView-tableFooterView设置" class="headerlink" title="6、隐藏TableView的tableHeaderView/tableFooterView设置"></a>6、隐藏TableView的tableHeaderView/tableFooterView设置</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//不能直接设置tableHeaderView/tableFooterView的frame为0（无效，此时系统会使用tableHeaderView/tableFooterView的默认frame）</span></div><div class="line"></div><div class="line"><span class="keyword">self</span>.tableView.tableHeaderView = [[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="built_in">CGFLOAT_MIN</span>)];</div><div class="line"></div><div class="line"><span class="keyword">self</span>.tableView.tableFooterView = [[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="built_in">CGFLOAT_MIN</span>)];</div></pre></td></tr></table></figure>
<h4 id="7、预估高度使用"><a href="#7、预估高度使用" class="headerlink" title="7、预估高度使用"></a>7、预估高度使用</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">self</span>.tableView.estimatedRowHeight = <span class="number">60</span>;</div><div class="line"><span class="comment">//设置值行高只适应</span></div><div class="line"><span class="keyword">self</span>.tableView.rowHeight = <span class="built_in">UITableViewAutomaticDimension</span>;</div><div class="line"><span class="comment">//可不实现下面方法，xib只适应高度</span></div><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath;</div></pre></td></tr></table></figure>
<h4 id="8、折叠所有section-header"><a href="#8、折叠所有section-header" class="headerlink" title="8、折叠所有section header"></a>8、折叠所有section header</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">numberOfRowsInSection: 如果反回的行数为<span class="number">0</span> 那么 cellForRowAtIndexPath： 是不会调用的</div><div class="line"></div><div class="line">为 **Model** 添加一个**<span class="keyword">bool</span>**属性， 用来记录该组是否折叠 ， 默认是 <span class="literal">NO</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>,<span class="keyword">getter</span>=isExplain) <span class="built_in">BOOL</span> explain;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="Lonely920" />
          <p class="site-author-name" itemprop="name">Lonely920</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">43</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lonely920</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  

  

  

</body>
</html>
